<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="yes" name="apple-touch-fullscreen"><meta content="telephone=no,email=no" name="format-detection"><meta name="Cache-Type" content="image/gif,image/png,image/jpg"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>管理收货地址</title><meta name="description" content=""><meta name="keywords" content="index"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-title" content=""><script src="../js/flexible.js"></script><script src="../js/flexible_css.js"></script><link rel="stylesheet" href="../css/main.css"><link rel="stylesheet" href="../css/user.css"><style>.address-box{padding-bottom:1.5rem}.address-item .address-edit em{margin-left:.83rem}</style></head><body><div class="navbar absolute"><div class="back_arrow back_home" id="back"></div><h1 id="navtitle">管理收货地址</h1><div id="rightBtn" style="display:none">管理</div></div><div class="mainContent" id="main"><div id="address-manage" style="display:none"><div class="address-box" id="manageBox"></div><div id="addNewAddress">添加新地址</div></div><div id="address-select" style="display:none"><div class="address-box" id="selectBox"></div></div></div><script src="../js/zepto.min.js"></script><script src="../js/main.js"></script><script>T.address=function(){var n={init:function(){n.initHashChange(),n.bindEvent()},initHashChange:function(){function e(){"manage"==(T.Util.getParaHash("page")||"manage")?($("#rightBtn").hide(),$("title,#navtitle").text("管理收货地址"),$("#address-manage").show().siblings().hide()):($("#rightBtn").show(),$("title,#navtitle").text("选择收货地址"),$("#address-select").show().siblings().hide()),n.getAddress()}"onhashchange"in window&&(window.addEventListener?window.addEventListener("hashchange",e,!1):window.attachEvent("onhashchange",e)),e()},bindEvent:function(){$("#addNewAddress").off().Touch(function(e){if(!$("#addNewAddress").is(".disabled")){var a=T.Util.getParaSearch("from");T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/user/editAddress.html"+(a?"?from="+a:""))}}),$("#rightBtn").off().Touch(function(){window.location.href="#page=manage"}),$(".address-edit h2").off().Touch(function(e){$(e).hasClass("default")||n.editAddress($(e).parent().attr("data-id"),"isDefault",function(){$(".default").removeClass("default"),$(e).addClass("default")})}),$(".address-edit .delete").off().Touch(function(a){confirm({html:"确认删除此收货地址？",okFun:function(){n.editAddress($(a).parent().attr("data-id"),"isDelete",function(){$(a).parent().parent().remove();var e=$("#manageBox .address-item").length;0==e?$("#manageBox").html('<li class="nodata address"><i></i><h2>您还没有收货地址哦~</h2></li>'):e<10&&$("#addNewAddress").removeClass("disabled")})}})}),$(".address-edit .edit").off().Touch(function(e){var a={userName:$(e).parent().attr("data-user-name"),userPhone:$(e).parent().attr("data-user-phone"),areaCode:$(e).parent().attr("data-area-code"),userAddr:$(e).parent().attr("data-user-addr"),area:$(e).parent().attr("data-area")};T.Storage.set("editAddressInfo",a),T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/user/editAddress.html?id="+$(e).parent().attr("data-id"))}),$(".selectItem").off().Touch(function(e){T.Storage.set("selectAddressInfo",JSON.parse($(e).attr("dataInfo"))),T.Util.back()})},getAddress:function(){T.Util.xmlHttpRequest({type:"get",reqUrl:"/user/services/user/userAddressList.json",callback:function(e){var a=e.res_data.value;n.showAddress(a)},errorCallback:function(){}})},showAddress:function(e){for(var a=[],t=[],s=0;s<e.length;s++){var d=e[s].AREA?e[s].AREA+e[s].USER_ADDR:e[s].USER_ADDR,i=e[s].IS_DEFAULT?'<h2 class="default">默认地址</h2>':"<h2>设为默认</h2>";a.push('<div class="address-item">                                <div class="address-info"><h2 class="username">'+e[s].USER_NAME+'</h2><p class="tel">'+e[s].USER_PHONE+'</p><p class="address">'+d+'</p></div>                                <div class="address-edit " data-id="'+e[s].ADDR_ID+'" data-user-name="'+e[s].USER_NAME+'" data-user-phone="'+e[s].USER_PHONE+'" data-area-code="'+e[s].AREA_CODE+'" data-user-addr="'+e[s].USER_ADDR+'" data-area="'+e[s].AREA+'">'+i+'<em class="delete">删除</em><em class="edit">编辑</em></div>                                </div>'),t.push('<div class="selectItem address-item '+(e[s].IS_DEFAULT?"default":"")+"\" dataInfo='"+JSON.stringify(e[s])+"' data-id=\""+e[s].ADDR_ID+'">                                <div class="address-info"><h2 class="username">'+e[s].USER_NAME+'</h2><p class="tel">'+e[s].USER_PHONE+'</p><p class="address">'+d+"</p></div>                                </div>")}a.length?($("html,body").removeClass("white"),$("#manageBox").html(a.join("")),$("#selectBox").html(t.join(""))):($("html,body").addClass("white"),$("#manageBox,#selectBox").html('<li class="nodata address"><i></i><h2>您还没有收货地址哦~</h2></li>')),10<=e.length?$("#addNewAddress").addClass("disabled"):$("#addNewAddress").removeClass("disabled"),n.bindEvent()},editAddress:function(e,a,t){var s={data:{addrId:e}};"isDefault"==a&&(s.data.isDefault="1"),"isDelete"==a&&(s.data.isDelete="1"),T.Util.xmlHttpRequest({type:"post",reqData:s,reqUrl:"/user/services/user/userAddress.json",callback:function(e){tip("isDefault"==a?"设置成功":"删除成功","ok"),t()},errorCallback:function(){}})}};return{init:n.init}}(),$(document).ready(function(){T.isNative?T.appToH5.init(function(){T.address.init()},function(){T.address.init()},function(){},function(){},function(){}):T.address.init()})</script></body></html>