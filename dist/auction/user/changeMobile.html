<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="yes" name="apple-touch-fullscreen"><meta content="telephone=no,email=no" name="format-detection"><meta name="Cache-Type" content="image/gif,image/png,image/jpg"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>更换手机号码</title><meta name="description" content=""><meta name="keywords" content="index"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-title" content=""><script src="../js/flexible.js"></script><script src="../js/flexible_css.js"></script><link rel="stylesheet" href="../css/main.css"><link rel="stylesheet" href="../css/login.css"></head><body><div class="navbar"><div class="back_arrow back_home" id="back"></div><h1>更换手机号码</h1></div><div class="mainContent" id="main"><div id="pwdfind-box"><div class="pwdfind-item tel"><div class="pwdfind-wrapper"><input id="tel" type="tel" maxlength="11" placeholder="请输入当前的手机号码"></div><i class="clear"></i></div><div class="pwdfind-item tel"><div class="pwdfind-wrapper"><input id="newtel" type="tel" maxlength="11" placeholder="请输入新的手机号码"></div><i class="clear"></i></div><div class="pwdfind-item message"><div class="pwdfind-wrapper"><input id="message" maxlength="6" placeholder="请输入验证码"><div id="getMessage">获取验证码</div></div></div></div><div class="pwdfind-btn" id="pwdfind_submit">提交</div></div><script src="../js/zepto.min.js"></script><script src="../js/main.js?v=0.01"></script><script>T.changeMobile=function(){var i=!1,o=function(t){if(""==t)tip("请输入当前的手机号码！");else{if(/^1\d{10}$/.test(t))return!0;tip("手机号码不正确，请重新输入")}},a=function(t,e){if(""==e)tip("请输入新的手机号码！");else if(/^1\d{10}$/.test(e)){if(e!=t)return!0;tip("新绑定的手机号不能与旧手机号一致")}else tip("手机号码不正确，请重新输入")},s=function(t){if(i)if(""==t)tip("请输入短信验证码！");else{if(6==t.length)return!0;tip("请输正确的短信验证码！")}else tip("请获取短信验证码")},r={init:function(){r.initPage(),r.bindEvent()},initPage:function(){T.Storage.get("access_token")||T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/user/login.html")},getMessageCode:function(t,e,n){if(o(t)){var i={event:e,userAcct:t};T.Util.xmlHttpRequest({type:"post",reqData:{data:i},reqUrl:"/user/services/user/sendCode.json",callback:function(t){tip("验证码已发送","ok"),n(t)},errorCallback:function(){$("#getMessage").removeClass("no")}})}},countDown:function(){var t=60,e=setInterval(function(){t--,$("#getMessage").html(t+"秒后重发!"),0==(dds=t)&&(clearInterval(e),$("#getMessage").html("获取验证码").removeClass("no"))},1e3)},bindEvent:function(){$("#getMessage").off().Touch(function(t){if(!$(t).hasClass("no")){var e=$("#tel").val().trim(),n=$("#newtel").val().trim();o(e)&&a(e,n)&&r.getMessageCode(n,"CHANGE_PHONE",function(){i=!0,$("#getMessage").addClass("no"),r.countDown()})}}),$("#pwdfind_submit").off().Touch(function(){var t=$("#tel").val().trim(),e=$("#newtel").val().trim(),n=$("#message").val().trim();r.changeMobile(t,e,n)}),$("input").on("input",function(){T.Util.trim($("#tel").val());0<$(this).val().length?$(this).parent().parent().addClass("writing"):$(this).parent().parent().removeClass("writing")}),$("input").on("blur",function(){$(this).parent().parent().removeClass("writing")}),$(".clear").off().Touch(function(){$(this).parent().find("input").val(""),$(this).parent().removeClass("writing")})},changeMobile:function(t,n,e){if(o(t)&&a(t,n)&&s(e)){var i="/user/services/user/updateInfo.json?event=CHANGE_PHONE&newVal="+t+","+n+"&code="+e;T.Util.xmlHttpRequest({type:"get",reqUrl:i,callback:function(t){tip("手机号码更新成功","ok");var e=T.Storage.get("userinfo");$.extend(e,{userMobile:T.Util.hideMidStr(n,3,4)}),T.Storage.set("userinfo",e),setTimeout(function(){T.Util.back()},3e3)},errorCallback:function(){}})}}};return{init:r.init}}(),$(document).ready(function(){T.isNative?T.appToH5.init(function(){T.changeMobile.init()},function(){},function(){},function(){},function(){}):T.changeMobile.init()})</script></body></html>