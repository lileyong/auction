<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="yes" name="apple-touch-fullscreen"><meta content="telephone=no,email=no" name="format-detection"><meta name="Cache-Type" content="image/gif,image/png,image/jpg"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>我的银行卡</title><meta name="description" content=""><meta name="keywords" content="index"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-title" content=""><script src="../js/flexible.js"></script><script src="../js/flexible_css.js"></script><link rel="stylesheet" href="../css/main.css"><link rel="stylesheet" href="../css/user.css"></head><body><div class="navbar"><div class="back_arrow back_home" id="back"></div><h1>我的银行卡</h1><div id="rightBtn" style="display:none">编辑</div></div><div class="mainContent" id="main"><div id="bankcard-box"></div><div id="addbankcard" style="display:none"><h2>添加银行卡</h2></div></div><script src="../js/zepto.min.js"></script><script src="../js/main.js"></script><script>T.myBankCard=function(){var o={init:function(){o.initPage(),o.getBankCardList(),o.bindEvent()},initPage:function(){T.Storage.get("access_token")||T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/user/login.html")},loadCache:function(){var t=T.Storage.get("bankCardList");t&&t.length&&o.showBankCardList(t)},editBank:function(t,n,a){T.Util.xmlHttpRequest({type:"get",reqUrl:"/user/services/user/addBankcard.json?cardId="+t+"&type="+n,callback:function(t){a()},errorCallback:function(){}})},getBankCardList:function(){T.Util.xmlHttpRequest({type:"get",reqUrl:"/user/services/user/bankCardList.json",callback:function(t){var n=t.res_data.value.INFO;o.showBankCardList(n),T.Storage.set("bankCardList",n)},errorCallback:function(t,n,a){"timeout"==a||"abort"==a||"error"==a?($("#main").html('<div class="nonet"><i></i><h2>您的网络不稳定，请刷新重试~</h2><div id="page-refresh" class="btn">刷新</div></div>'),$("#page-refresh").off().Touch(function(){window.location.reload()})):setTimeout(function(){tip(t?t.msg:Global.neterror,"error")},500)}})},showBankCardList:function(t){for(var n=[],a=0;a<t.length;a++){var e=1==parseInt(t[a].IS_DEFAULT)?"default":"",i=1==parseInt(t[a].IS_VALIDATE)?"valid":"invalid";n.push('<div class="backcard-item '+i+'" style="background: '+t[a].BANK_COLOR+'" data-id="'+t[a].ID+'" data-desc="'+t[a].BANK_CNAME+"（尾号"+t[a].CARD_NO+'）">                                <img src="'+T.Util.getFullPic(t[a].BANK_ICON)+'">                                <h2 class="bankname">'+t[a].BANK_CNAME+'</h2>                                <p class="cardtype">储蓄卡</p>                                <p class="cardno">**** **** **** '+t[a].CARD_NO+'</p>                            <i class="setdefault '+e+'"></i>                                <i class="delete"></i>                                </div>')}t.length?($("#rightBtn").show(),$("#bankcard-box").html(n.join(""))):$("#rightBtn").hide(),t.length<5?$("#addbankcard").show():$("#addbankcard").hide(),o.bindEvent()},bindEvent:function(){$("#rightBtn").off().Touch(function(){$("#rightBtn,.backcard-item").toggleClass("edit"),$(this).is(".edit")?$(this).text("完成"):$(this).text("编辑")}),$(".setdefault").off().Touch(function(n){if($(this).is(".default"))return!1;confirm({className:"bankcard",html:"是否将<b>"+$(n).parent().attr("data-desc")+"</b>设置为默认支付/提现银行卡？",okText:"确定",okFun:function(){o.editBank($(n).parent().attr("data-id"),"1",function(){var t=$(n).parent().clone();t.find(".setdefault").addClass("default"),$(n).parent().siblings().find(".setdefault").removeClass("default"),$(n).parent().remove(),$("#bankcard-box").prepend(t),o.bindEvent(),tip("设置成功！","ok")})}})}),$(".delete").off().Touch(function(t){var n=$(this);confirm({className:"bankcard",html:"亲，确认删除该银行卡？",okText:"确定",okFun:function(){o.editBank($(t).parent().attr("data-id"),"2",function(){n.parent().remove(),tip("删除成功！","ok")})}})}),$("#addbankcard").off().Touch(function(t){var n=T.Storage.get("userinfo");n.realName&&n.idCard?T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/user/addBankCard.html"):confirm({html:"请先进行实名认证",okFun:function(){T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/user/identityInfo.html")},cancelFun:function(){T.Util.back()}})})}};return{init:o.init}}(),$(document).ready(function(){T.isNative?T.appToH5.init(function(){T.myBankCard.init()},function(){T.myBankCard.init()},function(){},function(){},function(){}):T.myBankCard.init()})</script></body></html>