<style>#auctionlist-box{overflow:hidden}#auctionlist-tab{position:fixed;z-index:99;width:10rem;height:1.066667rem;background-color:#fff;border-bottom:.0533333rem solid #f5f5f5}#auctionlist-tabwrapper{margin:0 .453333rem;height:1.066667rem;overflow:hidden;white-space:nowrap}#auctionlist-tab em{float:left;display:inline-block;min-width:1.026667rem;line-height:1.066667rem;padding-right:.4rem;font-size:.373333rem;color:#666}#auctionlist-tab em.on{color:#f72f2f}#auctionlist-tab em:last-child{padding-right:0}#auctionlist{margin-top:1.08rem}</style><div class="content" id="content"><div id="auctionlist-box"><div id="auctionlist-tab" style="display:none"><div id="auctionlist-tabwrapper"></div></div><div id="auctionlist"><ul class="shopBox" id="shopBox"></ul></div></div></div><script>T.auctionList=function(){var t={hot:"全部热拍",pre:"预约拍",collect:"我的收藏",intelligent:"智能推荐",my:"我在拍"},s=T.Util.getPara("type")||"hot",o=!1,e="",c=1,d=!1,a=!0,u="",h={init:function(){c=1,$("title,#navtitle").text(t[s]),"hot"==s||"intelligent"==s||"pre"==s?h.getShopType():($("#auctionlist-tab").hide(),$("#auctionlist").css("margin-top",0),"collect"==s?h.getMyFavorite():"my"==s&&h.getMyAuction()),h.bindEvent()},bindEvent:function(){$(window).off().scroll(h.loadMoreData),$("#auctionlist").off().dropload({scrollArea:window,loadUpFn:function(t){e=t,c=1,"collect"==s?h.getMyFavorite():"my"==s?h.getMyAuction():h.getShopType()},threshold:50}),$("#auctionlist-tabwrapper em").off().Touch(function(t){$(t).hasClass("on")||h.tabSwitch($(t).index())})},loadIscroll:function(t){o?t&&t():T.Util.jsLoad("../js/iScroll.js",function(){o=!0,t&&t()})},tabScroll:function(t){$("#auctionlist-tab").width(window.innerWidth);var o=$("#auctionlist-tabwrapper em"),i=68;$.each(o,function(t,o){i+=o.offsetWidth}),$("#auctionlist-tabwrapper").css({width:i}),window.auctionListScroll=new iScroll("#auctionlist-tab",{bounce:!0,scrollX:!0,scrollY:!1,startX:t}),auctionListScroll.refresh(),setTimeout(function(){auctionListScroll.refresh()},200)},loadMoreData:function(){if("auctionList.html"==T.Util.getPara("page")){var t=$(this).scrollTop()+5;$(document).height()<=t+$(this).height()&&a&&d&&("collect"==s?h.getMyFavorite(!0):"my"==s?h.getMyAuction(!0):h.getAuctionList(!0))}},getShopType:function(r){tip("加载中...","loading"),T.Util.xmlHttpRequest({type:"get",reqUrl:"/commodity/services/shop/shopType.json?type="+("hot"==s?3:"pre"==s?4:2)+"&page="+c+"&limit=10",callback:function(t){pageLoading.hide();for(var o=[],i=t.res_data.value.COL_LIST,e=0;e<i.length;e++)0==e&&o.push("<em"+(u?"":' class="on"')+">全部</em>"),o.push('<em data-id="'+i[e].COLUMN_ID+'"'+(u&&u==i[e].COLUMN_ID?' class="on"':"")+">"+i[e].COLUMN_NAME+"</em>");if(o.length){var a=$("#auctionlist-tabwrapper").attr("style"),n=T.Util.getTranslate("#auctionlist-tabwrapper")[0]||0;$("#auctionlist-tab").show(),$("#auctionlist-tabwrapper").html(o.join("")).attr("style",a).show()}else $("#auctionlist-tab").hide();if(h.loadIscroll(function(){h.tabScroll(n)}),$("#auctionlist-tabwrapper em").off().Touch(function(t){$(t).hasClass("on")||($("#intelligentBox").hide(),$(t).addClass("on").siblings().removeClass("on"),$("#shopBox").html(""),c=1,u=$(t).attr("data-id"),h.getAuctionList())}),u)h.getAuctionList(r);else{var l=t.res_data.value.INFO;2==t.res_data.value.ISEND?(d=!0,c++):d=!1,h.showAuctionList(l,r)}"my"!=s&&"pre"!=s&&"collect"!=s||T.Util.showGoodsRecommend()},errorCallback:function(t,o,i){pageLoading.hide(),""!=e&&(e.resetload(),e.unlock(),e.noData(!1),e=""),"timeout"==i||"abort"==i||"error"==i?($("#auctionlist-box").html('<div class="nonet"><i></i><h2>您的网络不稳定，请刷新重试~</h2><div id="page-refresh" class="btn">刷新</div></div>'),$("#page-refresh").off().Touch(function(){window.location.reload()})):setTimeout(function(){tip(t?t.msg:Global.neterror,"error")},500)}})},getAuctionList:function(i){a=!1,tip("加载中...","loading");var t="/commodity/services/shop/shopType.json?type="+("hot"==s?3:"pre"==s?4:2)+"&page="+c+"&limit=10";u&&!T.Util.isEmpty(u)&&(t=t+"&colId="+u),T.Util.xmlHttpRequest({type:"get",errorType:1,reqUrl:t,callback:function(t){pageLoading.hide(),a=!0;var o=t.res_data.value.INFO;2==t.res_data.value.ISEND?(d=!0,c++):d=!1,h.showAuctionList(o,i)},errorCallback:function(t,o,i){pageLoading.hide(),a=!0,""!=e&&(e.resetload(),e.unlock(),e.noData(!1),e=""),"timeout"==i||"abort"==i||"error"==i?($("#auctionlist-box").html('<div class="nonet"><i></i><h2>您的网络不稳定，请刷新重试~</h2><div id="page-refresh" class="btn">刷新</div></div>'),$("#page-refresh").off().Touch(function(){window.location.reload()})):setTimeout(function(){tip(t?t.msg:Global.neterror,"error")},500)}})},showAuctionList:function(t,o){var i=T.Util.doShopListHtml(t);""!=e&&($("#shopBox").html(""),e.resetload(),e.unlock(),e.noData(!1),e=""),i.length?($("html,body").removeClass("white"),$("#shopBox").append(i.join("")),T.Util.shopListClick()):o||($("html,body").addClass("white"),$("#shopBox").html('<li class="nodata '+T.Util.getParaHash("type")+'"><i></i><h2>暂无数据~</h2>'+("hot"==s?"":'<div class="btn">立即去竞拍</div>')+"</li>"),$(".nodata .btn").off().Touch(function(){T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/view/go.html#page=auctionList.html&type=hot")})),$("#intelligentBox").show(),lozad().observe()},getMyAuction:function(i){tip("加载中...","loading"),a=!1,T.Util.xmlHttpRequest({type:"get",errorType:1,reqUrl:"/commodity/services/product/myAuction.json?page="+c+"&limit=10&type=1",callback:function(t){pageLoading.hide(),a=!0;var o=t.res_data.value.INFO;2==t.res_data.value.ISEND?(d=!0,c++):d=!1,h.showAuctionList(o,i),"my"!=s&&"pre"!=s&&"collect"!=s||T.Util.showGoodsRecommend()},errorCallback:function(t,o,i){pageLoading.hide(),a=!0,""!=e&&(e.resetload(),e.unlock(),e.noData(!1),e=""),"timeout"==i||"abort"==i||"error"==i?($("#auctionlist-box").html('<div class="nonet"><i></i><h2>您的网络不稳定，请刷新重试~</h2><div id="page-refresh" class="btn">刷新</div></div>'),$("#page-refresh").off().Touch(function(){window.location.reload()})):setTimeout(function(){tip(t?t.msg:Global.neterror,"error")},500)}})},getMyFavorite:function(i){tip("加载中...","loading"),a=!1,T.Util.xmlHttpRequest({type:"get",reqUrl:"/commodity/services/product/myFavorite.json?page="+c+"&limit=10",callback:function(t){pageLoading.hide(),a=!0;var o=t.res_data.value.INFO;2==t.res_data.value.ISEND?(d=!0,c++):d=!1,h.showAuctionList(o,i),"my"!=s&&"pre"!=s&&"collect"!=s||T.Util.showGoodsRecommend()},errorCallback:function(t,o,i){pageLoading.hide(),a=!0,""!=e&&(e.resetload(),e.unlock(),e.noData(!1),e=""),"timeout"==i||"abort"==i||"error"==i?($("#auctionlist-box").html('<div class="nonet"><i></i><h2>您的网络不稳定，请刷新重试~</h2><div id="page-refresh" class="btn">刷新</div></div>'),$("#page-refresh").off().Touch(function(){window.location.reload()})):setTimeout(function(){tip(t?t.msg:Global.neterror,"error")},500)}})}};return{init:h.init}}(),$(document).ready(function(){T.auctionList.init()})</script>