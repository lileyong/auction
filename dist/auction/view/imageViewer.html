<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="yes" name="apple-touch-fullscreen"><meta content="telephone=no,email=no" name="format-detection"><meta name="Cache-Type" content="image/gif,image/png,image/jpg"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>查看图片</title><meta name="description" content=""><meta name="keywords" content="index"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-title" content=""><script src="../js/flexible.js"></script><script src="../js/flexible_css.js"></script><link rel="stylesheet" href="../css/main.css"><link rel="stylesheet" href="../css/imageViewer.css"></head><body><div id="viewer"><div id="navbar" class="navbar"><div class="back_arrow back_home" id="back"></div><h1 id="navTitle">1/3</h1><span id="delete" class="hide"></span></div><div id="viewBox"><div id="imgList"></div></div><div id="deleteBox" class="hidden"><h2>要删除这张照片吗？</h2><div class="deleteBtn" id="deleteOk">删除</div><div class="deleteBtn" id="deleteCancel">取消</div></div></div><script src="../js/zepto.min.js"></script><script src="../js/main.js?v=0.01"></script><script>!function(s){function l(){p=null,T.last&&(T.el.trigger("longTap"),T={})}function g(){p&&clearTimeout(p),p=null}function c(){m&&clearTimeout(m),f&&clearTimeout(f),h&&clearTimeout(h),p&&clearTimeout(p),m=f=h=p=null,T={}}function d(e){return("touch"==e.pointerType||e.pointerType==e.MSPOINTER_TYPE_TOUCH)&&e.isPrimary}function u(e,i){return e.type=="pointer"+i||e.type.toLowerCase()=="mspointer"+i}var m,f,h,p,v,T={};s(document).ready(function(){var i,t,n,a,o=0,r=0;"MSGesture"in window&&((v=new MSGesture).target=document.body),s(document).bind("MSGestureEnd",function(e){var i=1<e.velocityX?"Right":e.velocityX<-1?"Left":1<e.velocityY?"Down":e.velocityY<-1?"Up":null;i&&(T.el.trigger("swipe"),T.el.trigger("swipe"+i))}).on("touchstart MSPointerDown pointerdown",function(e){(a=u(e,"down"))&&!d(e)||(n=a?e:e.touches[0],e.touches&&1===e.touches.length&&T.x2&&(T.x2=void 0,T.y2=void 0),i=Date.now(),t=i-(T.last||i),T.el=s("tagName"in n.target?n.target:n.target.parentNode),m&&clearTimeout(m),T.x1=n.pageX,T.y1=n.pageY,0<t&&t<=250&&(T.isDoubleTap=!0),T.last=i,p=setTimeout(l,750),v&&a&&v.addPointer(e.pointerId))}).on("touchmove MSPointerMove pointermove",function(e){(a=u(e,"move"))&&!d(e)||(n=a?e:e.touches[0],g(),T.x2=n.pageX,T.y2=n.pageY,o+=Math.abs(T.x1-T.x2),r+=Math.abs(T.y1-T.y2))}).on("touchend MSPointerUp pointerup",function(e){(a=u(e,"up"))&&!d(e)||(g(),T.x2&&30<Math.abs(T.x1-T.x2)||T.y2&&30<Math.abs(T.y1-T.y2)?h=setTimeout(function(){var e,i,t,n;T.el.trigger("swipe"),T.el.trigger("swipe"+(e=T.x1,i=T.x2,t=T.y1,n=T.y2,Math.abs(e-i)>=Math.abs(t-n)?0<e-i?"Left":"Right":0<t-n?"Up":"Down")),T={}},0):"last"in T&&(o<30&&r<30?f=setTimeout(function(){var e=s.Event("tap");e.cancelTouch=c,T.el.trigger(e),T.isDoubleTap?(T.el&&T.el.trigger("doubleTap"),T={}):m=setTimeout(function(){m=null,T.el&&T.el.trigger("singleTap"),T={}},250)},0):T={}),o=r=0)}).on("touchcancel MSPointerCancel pointercancel",c),s(window).on("scroll",c)}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(i){s.fn[i]=function(e){return this.on(i,e)}})}(Zepto),T.imageViewer=function(){var x=T.Util.getPara("source"),b={init:function(){b.loadImage(),b.bindEvent()},loadImage:function(){var e=T.Storage.get("imageViewerData");e&&e.imgList.length&&($.each(e.imgList,function(e,i){$("#viewer #imgList").append('<div class="imgitem" data-index="'+$("#viewer #imgList .imgitem").length+'"><div class="imgcell"><img src="'+i+'"></div></div>')}),b.initImgScroll(e.index),setTimeout(function(){$(".navbar").addClass("slideUp")},600))},bindEvent:function(){$("#delete").off().Touch(function(){$("#deleteBox").removeClass("hidden")}),$("#deleteOk").off().Touch(function(){parseInt($("#viewer .imgitem").eq(T.viewerIndex).attr("data-index"));$("#viewer #imgList .imgitem").eq(T.viewerIndex).remove(),$("#addshaidan-imglist .imgitem").eq(T.viewerIndex).remove(),$("#deleteBox").addClass("hidden"),setTimeout(function(){$("#viewer #imgList .imgitem").length?b.initImgScroll(T.viewerIndex):T.Util.back(),$("#addImg").show(),setTimeout(function(){tip("已删除","ok")},300)},10)}),$("#deleteCancel").off().Touch(function(){$("#deleteBox").addClass("hidden")})},initImgScroll:function(e,i){var t=$("#viewer #imgList .imgitem").length;e<0?e=0:t-1<e&&(e=t-1),T.viewerIndex=e,$("#navTitle").text(e+1+"/"+t),b.imgScroll(t,e,i)},getLargeLen:function(e){for(var i=0,t=0,n=$("#imgList .imgitem"),a=0;a<n.length;a++)n.eq(a).find("img").is(".larger")&&(i+=1);for(a=0;a<e;a++)n.eq(a).find("img").is(".larger")&&(t+=1);return[i,t]},imgScroll:function(t,i,n){var a=!1,o=!0,r=!0,s=0,l=0,g=0,c=0,d=0,u=0,m=0,f=0,h=(i=i,window.innerWidth),p=b.getLargeLen(i)[0],v=b.getLargeLen(i)[1],w=$("#imgList").css({marginLeft:-i*h-(.5*v+(n?.25:0))*h+"px",width:10*t+5*p+"rem"});w.off().on("touchstart",function(e){e.preventDefault(),$("#deleteBox").addClass("hidden"),setTimeout(function(){a||$(".navbar").toggleClass("slideUp")},10);try{s=e.changedTouches[0].clientX,d=e.changedTouches[0].clientY,g=parseInt(w.css("margin-left")),m=parseInt(w.css("padding"))}catch(e){}}),w.on("touchmove",function(e){e.preventDefault();try{l=e.changedTouches[0].clientX,u=e.changedTouches[0].clientY,c=parseInt(w.css("margin-left")),f=parseInt(w.css("padding"));var i=.8-Math.abs((c-g)/h),t=(Math.abs((f-m)/h),c+.8*i*i*(l-s));Math.abs(l-s)>=Math.abs(u-d)?o&&(w.css({"margin-left":t+"px"},500),r=!1):r&&(o=!1),1<l-s||1<u-d?(a=!0,$(".navbar").addClass("slideUp")):(a=!1,$(".navbar").toggleClass("slideUp"))}catch(e){}}),w.on("touchend",function(e){e.preventDefault();try{a=!1,c=parseInt(w.css("margin-left")),(i=g<c?Math.floor(-(c+.5*v*h)/h):Math.ceil(-(c+.5*(n?v+1:v)*h)/h))<0?i=0:t-1<i&&(i=t-1),T.viewerIndex=i,p=b.getLargeLen(i)[0],v=b.getLargeLen(i)[1],n=$('.imgitem[data-index="'+T.viewerIndex+'"]').find("img").is(".larger"),$("#navTitle").text(i+1+"/"+t),Math.abs(l-s)>Math.abs(u-d)?0<l-s?w.animate({"margin-left":-(i*h+.5*v*h)+"px"},500):w.animate({"margin-left":-(i*h+.5*(n?v+1:v)*h)+"px"},500):$("#mallbanner").animate({padding:"0"},500),r=o=!0}catch(e){}}),w.on("singleTap",function(e){x&&"goodsDetailShare"==x&&T.Util.back()}),w.on("doubleTap",function(e){var i=$('.imgitem[data-index="'+T.viewerIndex+'"]');i.find("img").hasClass("larger")?(i.find("img").css({width:i.find("img").width()/1.5,height:i.find("img").height()/1.5}).removeClass("larger"),w.css({marginLeft:parseInt(w.css("marginLeft"))+.5*v*h}),b.initImgScroll(T.viewerIndex)):(w.css({width:10*t+5*p+"rem"}),i.find("img").css({width:1.5*i.find("img").width(),height:1.5*i.find("img").height()}).addClass("larger"),w.css({marginLeft:parseInt(w.css("marginLeft"))-(.5*v+.25)*h}),b.initImgScroll(T.viewerIndex,!0)),$(".navbar").toggleClass("slideUp")})}};return{init:b.init}}(),$(document).ready(function(){T.isNative?T.appToH5.init(function(){T.imageViewer.init()},function(){},function(){},function(){},function(){}):T.imageViewer.init()})</script></body></html>