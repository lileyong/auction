<style>#mallbox{overflow:hidden}.shoptab{position:fixed;z-index:99;width:10rem!important;height:1.066667rem;overflow:hidden;background-color:#fff;border-bottom:.0533334rem solid #f5f5f5}.shoptab-wrapper{margin:0 .453333rem;height:1.066667rem;overflow:hidden;white-space:nowrap}.shoptab em{float:left;display:inline-block;min-width:1.026667rem;line-height:1.066667rem;padding-right:.4rem;font-size:.373333rem;color:#666}.shoptab em.on{color:#f72f2f}.shoptab em:last-child{padding-right:0}#mallbox{background-color:#f5f5f5;padding-bottom:.36rem}#shopcontent{margin-top:1.08rem}.shoptitle{width:100%;height:1.066667rem;text-align:center;line-height:1.066667rem;background-color:#f5f5f5}.shoptitle h2{position:relative;display:inline-block;margin:auto;font-size:.426667rem;color:#ff2110}.shoptitle h2:before{content:'';position:absolute;left:-1.466667rem;top:0;display:inline-block;width:1.653333rem;height:1.066667rem;background:url(../img/goods/malltitle_left.png) 0 0/100% 100% no-repeat}.shoptitle h2:after{content:'';position:absolute;right:-1.466667rem;top:0;display:inline-block;width:1.653333rem;height:1.066667rem;background:url(../img/goods/malltitle_right.png) 0 0/100% 100% no-repeat}.shoptitle h2 em{margin:0 .093333rem}.banner{margin:.266667rem .333333rem 0 .333333rem}.banner img{width:100%}.shopbox{min-height:4.9333333rem;background-color:#fff;overflow:hidden}#ashBox,#gshBox,#pssBox{background:#f5f5f5}.brand{position:relative;border-radius:.16rem;background-color:#fff;overflow:hidden}.brand h2{padding-left:.266667rem;line-height:.666667rem;font-size:.346666rem;color:#f72f2f;width:6rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.brand p{padding-left:.266667rem;line-height:.48rem;font-size:.32rem;color:#666;max-width:6rem;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.brand1{display:block;margin:0 .333333rem;height:2.4rem}.brand1 h2{margin-top:.266667rem}.brand2 h2{margin-top:.1333333rem;width:2.2533333rem;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.brand2 p{width:2.186667rem}.brand1 img{position:absolute;right:.413333rem;top:.133333rem;height:2.133333rem}.brand2{float:left;width:calc(50% - .4rem);height:2.4rem}.shopbox .brand2.first{margin:.133333rem .066667rem 0 .333333rem}.shopbox .brand2.second{margin:.133333rem .333333rem 0 .066667rem;color:#ff720b}.shopbox .brand2.first h2{color:#ff4005}.shopbox .brand2.second h2{color:#ff720b}.brand2 img{position:absolute;right:.133333rem;top:.2rem;height:2rem}.goods{position:relative;float:left;width:50%;height:6.32rem;background-color:#fff;box-sizing:border-box;-webkit-box-sizing:border-box;border-bottom:.0266667rem solid #f5f5f5;overflow:hidden}.goods:nth-child(odd){border-right:.0266667rem solid #f5f5f5}.goods img{display:block;width:2.933333rem;height:2.933333rem;margin:auto;margin-top:.653333rem}.goods h2{text-align:center;padding:0 .16rem;line-height:.626667rem;margin-top:.346667rem;font-size:.373333rem;color:#333;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.goods p.desc{text-align:center;line-height:.48rem;padding:0 .16rem;font-size:.32rem;color:#999;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;padding:0 .3rem}.goods p.price{text-align:center;line-height:.813333rem;font-size:.506667rem;color:#f72f2f}.goods p.price em{position:relative;top:-.02666667rem;font-size:.3466667rem}</style><div id="content"><div id="mallbox"><div class="shoptab" id="malltab"><div class="shoptab-wrapper" id="malltab-wrapper"></div></div><div id="shopcontent"><div id="shopIndexBox"><div class="shoptitle" data-type="gsh"><h2>购<em>/</em>实<em>/</em>惠</h2></div><div class="shopbox" id="gshBox"></div><div class="banner"><div class="imglist"><img src="../img/goods/banner.png"></div></div><div class="shoptitle" data-type="ash"><h2>爱<em>/</em>生<em>/</em>活</h2></div><div class="shopbox" id="ashBox"></div><div class="shoptitle" data-type="pss"><h2>品<em>/</em>时<em>/</em>尚</h2></div><div class="shopbox" id="pssBox"></div><div class="shoptitle"><h2>热<em>/</em>品<em>/</em>好<em>/</em>货</h2></div><div class="shopbox" id="hotShopBox"></div></div><div id="shopOtherBox" class="hide"><div class="shopbox" id="otherShopBox"></div></div></div></div><div class="clearboth"></div></div><script>T.mall=function(){var l="",n="",s=1,r=!1,d=!0,o=!1,h={init:function(){h.loadCache(),h.initPage(),h.getShopType(),h.getIndexShop(),h.getHotShop(),h.bindEvent()},initPage:function(){s=1,$(".pageType p[data-href]").eq(3).addClass("on").siblings().removeClass("on"),T.isNative||$(".clearboth").addClass("h5"),$("#shopIndexBox").show().siblings().hide()},loadCache:function(){var t=T.Storage.get("mall");t&&$("#content").html(t)},bindEvent:function(){$(window).off().scroll(h.loadMoreData),$("#shopcontent").off().dropload({scrollArea:window,loadUpFn:function(t){n=t,s=1;var o=$("#malltab-wrapper em.on").attr("data-id");o?h.getShopList(o):(h.getIndexShop(),h.getHotShop(),h.getShopType())},threshold:50}),$(".shoptitle[data-type]").off().Touch(function(t){T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/view/go.html#page=benefit.html&type="+$(t).attr("data-type"))})},loadMoreData:function(){var t=$(this).scrollTop()+5;if($(document).height()<=t+$(this).height()&&d&&r){var o=$("#malltab-wrapper em.on").attr("data-id");o?h.getShopList(o,!0):h.getHotShop(!0)}},loadIscroll:function(t){o?t&&t():T.Util.jsLoad("../js/iScroll.js",function(){o=!0,t&&t()})},tabScroll:function(){$("#malltab").width(window.innerWidth);var t=$("#malltab-wrapper em"),a=68;$.each(t,function(t,o){a+=o.offsetWidth}),$("#malltab-wrapper").css({width:a}),window.auctionListScroll=new iScroll("#malltab",{bounce:!0,scrollX:!0,scrollY:!1}),auctionListScroll.refresh(),setTimeout(function(){auctionListScroll.refresh()},200)},getShopType:function(){T.Util.xmlHttpRequest({type:"get",reqUrl:"/commodity/services/shop/shopType.json?type=1",callback:function(t){var o=[],a=t.res_data.value.COL_LIST;o.push('<em class="on">全部</em>');for(var e=0;e<a.length;e++)o.push('<em data-id="'+a[e].COLUMN_ID+'">'+a[e].COLUMN_NAME+"</em>");$("#malltab-wrapper").html(o.join("")),setTimeout(function(){/mall.html/.test(window.location.href)&&T.Storage.set("mall",$("#content").html().replace(/\ssrc="http.+?"/gi,' src="../img/goods/lazy_load.png" data-loaded="true"'))},10),h.loadIscroll(h.tabScroll),$("#malltab-wrapper em").off().Touch(function(t){$(t).hasClass("on")||(window.scrollTo(0,0),$(t).addClass("on").siblings().removeClass("on"),s=1,l=$(t).attr("data-id"),T.Util.isEmpty(l)?$("#shopIndexBox").show().siblings().hide():$("#shopOtherBox").show().siblings().hide(),h.getShopList(l))})},errorCallback:function(t,o,a){"timeout"!=a&&"abort"!=a&&"error"!=a||$(".brand ").length||($("#mallbox").html('<div class="nonet"><i></i><h2>您的网络不稳定，请刷新重试~</h2><div id="page-refresh" class="btn">刷新</div></div>'),$("#page-refresh").off().Touch(function(){window.location.reload()}))}})},getIndexShop:function(){T.Util.xmlHttpRequest({type:"get",reqUrl:"/commodity/services/shop/tagCode.json?tag=9,7,8",callback:function(t){var o=[],a=[],e=[],l=t.res_data.value;for(i in l)for(var n=l[i],s=0;s<n.length;s++){var r=0==s?"brand1":1==s?"brand2 first":"brand2 second";7==i&&o.push('<div class="brand '+r+'" data-id="'+n[s].COMMODITY_ID+'">                                    <img src="'+n[s].COMMODITY_LOGO+'">                                        <h2>'+(n[s].COMMODITY_NAME||"&nbsp")+"</h2>                                        <p>"+(n[s].MALL_PRODUCT_NOTE||"&nbsp")+"</p>                                </div>"),8==i&&a.push('<div class="brand '+r+'" data-id="'+n[s].COMMODITY_ID+'">                                    <img src="'+n[s].COMMODITY_LOGO+'">                                        <h2>'+(n[s].COMMODITY_NAME||"&nbsp")+"</h2>                                        <p>"+(n[s].MALL_PRODUCT_NOTE||"&nbsp")+"</p>                                </div>"),9==i&&e.push('<div class="brand '+r+'" data-id="'+n[s].COMMODITY_ID+'">                                    <img src="'+n[s].COMMODITY_LOGO+'">                                        <h2>'+(n[s].COMMODITY_NAME||"&nbsp")+"</h2>                                        <p>"+(n[s].MALL_PRODUCT_NOTE||"&nbsp")+"</p>                                </div>")}$("#gshBox").html(e.join("")),$("#ashBox").html(o.join("")),$("#pssBox").html(a.join("")),setTimeout(function(){/mall.html/.test(window.location.href)&&T.Storage.set("mall",$("#content").html().replace(/\ssrc="http.+?"/gi,' src="../img/goods/lazy_load.png" data-loaded="true" '))},10),$(".brand").off().Touch(function(t){T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/view/go.html#page=mallDetail.html&id="+$(t).attr("data-id"))})},errorCallback:function(){}})},getHotShop:function(l){d=!1,T.Util.xmlHttpRequest({type:"get",reqUrl:"/commodity/services/template/HOM_SHOP.json?page="+s+"&limit=10",callback:function(t){d=!0;var o=[],a=t.res_data.INFO;2==t.res_data.ISEND?(r=!0,s++):r=!1;for(var e=0;e<a.length;e++)o.push('<div class="goods" data-id="'+a[e].COMMODITY_ID+'">                                <img class="lozad"  src="../img/goods/lazy_load.png" data-src="'+a[e].COMMODITY_LOGO+'">                                <h2>'+(a[e].COMMODITY_NAME||"&nbsp")+'</h2>                            <p class="desc">'+(a[e].MALL_PRODUCT_NOTE||"&nbsp")+'</p>                                <p class="price"><em>￥</em>'+a[e].MARKET_PRICE.toFixed(2)+"</p>                            </div>");""!=n&&($("#hotShopBox").html(""),n.resetload(),n.unlock(),n.noData(!1),n=""),o.length?($("html,body").removeClass("white"),l?$("#hotShopBox").append(o.join("")):$("#hotShopBox").html(o.join(""))):l||($("html,body").addClass("white"),$("#hotShopBox").html('<div class="nodata"><i></i><h2>暂无数据~</h2></div>')),lozad().observe(),setTimeout(function(){/mall.html/.test(window.location.href)&&T.Storage.set("mall",$("#content").html().replace(/\ssrc="http.+?"/gi,' src="../img/goods/lazy_load.png" data-loaded="true"'))},10),$("#hotShopBox .goods").off().Touch(function(t){T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/view/go.html#page=mallDetail.html&id="+$(t).attr("data-id"))})},errorCallback:function(){d=!0}})},getShopList:function(t,l){tip("加载中...","loading");var o="/commodity/services/shop/shopType.json?page="+s+"&limit=10&type=1";t&&!T.Util.isEmpty(t)&&(o="/commodity/services/shop/shopType.json?page="+s+"&limit=10&type=1&colId="+t),T.Util.xmlHttpRequest({type:"get",errorType:1,reqUrl:o,callback:function(t){pageLoading.hide();var o=t.res_data.value.INFO||[],a=[];"2"==t.res_data.value.ISEND?(r=!0,s++):r=!1;for(var e=0;e<o.length;e++)a.push('<div class="goods" data-id="'+o[e].COMMODITY_ID+'">                                <img src="'+o[e].COMMODITY_LOGO+'">                                <h2>'+(o[e].COMMODITY_NAME||"&nbsp")+'</h2>                                <p class="desc">'+(o[e].MALL_PRODUCT_NOTE||"&nbsp")+'</p>                                <p class="price"><em>￥</em>'+o[e].MARKET_PRICE.toFixed(2)+"</p>                            </div>");""!=n&&($("#otherShopBox").html(""),n.resetload(),n.unlock(),n.noData(!1),n=""),a.length?l?$("#otherShopBox").append(a.join("")):$("#otherShopBox").html(a.join("")):l||$("#otherShopBox").html('<div class="nodata" style="background-color: #f5f5f5;"><i></i><h2>暂无类别数据哦~</h2></div>'),setTimeout(function(){/mall.html/.test(window.location.href)&&T.Storage.set("mall",$("#content").html().replace(/\ssrc="http.+?"/gi,' src="../img/goods/lazy_load.png" data-loaded="true"'))},10),$(".goods").off().Touch(function(t){T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/view/go.html#page=mallDetail.html&id="+$(t).attr("data-id"))})},errorCallback:function(t){pageLoading.hide(),""!=n&&(n.resetload(),n.unlock(),n.noData(!1),n=""),setTimeout(function(){tip(t?t.msg:Global.neterror,"error")},500)}})}};return{init:h.init}}(),$(document).ready(function(){T.mall.init()})</script>