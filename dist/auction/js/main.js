window.Global||(Global={fullHost:window.location.origin,authHost:window.location.origin,apiHost:window.location.origin}),Global.isAndroid=-1<window.navigator.userAgent.indexOf("Android")||-1<window.navigator.userAgent.indexOf("Linux"),Global.isiOS=/iPhone|iPad|iPod|ios|IOS/.test(window.navigator.userAgent),Global.isQQ=/qq\//i.test(window.navigator.userAgent),Global.isWechat=/micromessenger/i.test(window.navigator.userAgent),Global.isWeibo=/weibo/i.test(window.navigator.userAgent),Global.language="en",Global.iosBtn=!1,Global.versionStr="web.0.0",Global.appCode=Global.isiOS?"30002":"30001",Global.webVersion="1101",Global.isFirst=!0,Global.neterror="当前网络不可用，请检查网络设置",Global.setAutoScroll=0,Global.trenchType="",Global.deviceCode="",Global.is_majia="",Global.is_game="",Global.show_wxpay="",Global.OS="web",Global.hasTipBox=!1,Global.netWorkStatus=1,Global.blankHeight=0,Global.webRoot="auction",Global.h_version="1.0.0",Global.caseTime=-1,Global.hasHeiping=!1,Global.noPic="../img/goods/lazy_load.png",Global.devicefp="",Global.inviteChannelCode="";var kefuhttpFlag=!(Global.isAudit=""),T={};T.isNative=/appInfo/.test(window.navigator.userAgent),T.isNative&&(Global.OS=Global.isAndroid?"Android":"IOS"),Number.prototype.toFixed=function(e){var t=(parseInt(this*Math.pow(10,e)+.5)/Math.pow(10,e)).toString();1e3*this%5==0&&1e3*this%10!=0&&(t=(parseInt(this*Math.pow(10,e+1)+5)/Math.pow(10,e+1)).toString(),t=(parseInt(t*Math.pow(10,e)+.5)/Math.pow(10,e)).toString());var o=t.indexOf(".");if(o<0&&0<e)for(t+=".",i=0;i<e;i++)t+="0";else for(o=t.length-o,i=0;i<e-o+1;i++)t+="0";return t};var pageFrom="";Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var o in/([Yy]+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+o+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[o]:("00"+t[o]).substr((""+t[o]).length)));return e};var Collection=function(){var o=["collect/req.json","match/state.json","game/getInvitationStatus","game/getRandomMatchStatus","game/getGameRecord"];return{collectFlag:!1,maxResTime:3,ignoreList:o,filterUrl:function(e){for(var t=0;t<o.length;t++)if(-1!=e.indexOf(o[t]))return!1;return!0},sendSize:10}}();T.Storage={is:function(){return!!window.localStorage},set:function(e,t,o){switch(typeof t){case"object":t="object:"+JSON.stringify(t);break;case"string":t="string:"+t}if(T.Storage.is()){var i=o?"sessionStorage":"localStorage";try{window[i].setItem(e,t)}catch(e){(-1<navigator.userAgent.indexOf("iPhone")||-1<navigator.userAgent.indexOf("iPad"))&&confirm("为了正常运行网站，请关闭Safari浏览器-秘密（无痕）浏览")}}},get:function(e,t){var o;return T.Storage.is()?(o=window[t?"sessionStorage":"localStorage"].getItem(e),/^object:/.test(o)?o=JSON.parse(o.replace(/^object\:/,"")):/^string:/.test(o)&&(o=o.replace(/^string\:/,"")),o):void 0},remove:function(e,t){T.Storage.is()&&window[t?"sessionStorage":"localStorage"].removeItem(e)},getAndRemove:function(e,t){var o=T.Storage.get(e,t);return o&&(T.Storage.remove(e,t),window.tempStorage=o),window.tempStorage}},window.noMore=function(e){var t='<div class="noMore-updates"><p>'+warnObj.noMoreData[Global.language]+"</p></div>";e?"string"==typeof e&&(e=$(e)):e=$("body"),e.find(".noMore-updates").length||e.append(t)},T.popTaskList=[],T.doPopTask=function(){setTimeout(function(){if(T.popTaskList.length){var e=T.popTaskList[0];T.popTaskList.splice(0,1),"alert"==e.type?alert(e.opt[0],e.opt[1],e.opt[2]):confirm(e.opt)}},500)},window.alert=function(e,t,o){if(0==$("#alertBox").height||e!=$("#alertBox p").html()){var i=$('<div id="alertBox" class="popBox"><div class="box-inner"><div class="box-content">                        <div class="confirmcontent"></div>                         <div class="confirmbutton"><div>OK</div></div></div></div></div>');if(0!=$("#alertBox").length||0!=$("#confirmBox").length)return T.popTaskList.push({type:"alert",opt:[e,t,o]}),!1;$("body").append(i),setTimeout(function(){$("#alertBox .box-content").addClass("show")},0),0==$("#mask").length&&$("body").append('<div id="mask" class="mask hide"></div>'),$(".confirmcontent").html(e),o&&$("#alertBox .confirmbutton div").html(o)||$("#alertBox .confirmbutton div").html("好的"),$("input,textarea").blur(),$("#numKeyWord").hide(),$("#mask, #alertBox").show(),$(".confirmcontent").height()<=152?$(".confirmcontent").css("padding","0.76rem 0.6933334rem"):$(".confirmcontent").css("padding","0.64rem 0.6933334rem"),setTimeout(function(){$(".popBox").css("opacity",1)},10),document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden",$("#mask").bind("touchmove",function(e){e.preventDefault()}),$("#alertBox .confirmbutton div").one("click",function(){var e;$(this).addClass("tapped"),clearTimeout(e),e=setTimeout(function(){$(".tapped").removeClass("tapped")},250),"function"==typeof t&&t(),$("#alertBox,#mask").remove(),document.documentElement.style.overflow="",document.body.style.overflow="",T.doPopTask()})}},window.confirm=function(t){var e=(t="string"==typeof t?{html:t}:t||{}).html,o=t.cancelText,i=t.okText,a=t.cancelFun,n=t.okFun,l=t.close,s=t.closeFun,r=t.isHideMask,d=t.className,c='<div id="confirmBox" class="popBox'+(d?" "+d:"")+'"><div class="box-inner"><div class="box-content">';if(d&&-1<d.indexOf("auctionSuccess")&&(c+='<div class="auctionSuccessStarBox"></div>'),c+='<div class="confirmcontent">'+e+"</div>",c+='<div class="confirmbutton"><div class="cancelText">'+(o||"取消")+'</div><div class="okText">'+(i||"好的")+"</div></div>",l&&(c+='<i id="close"></i>'),c+="</div></div></div>",0!=$("#alertBox").length||0!=$("#confirmBox").length)return T.popTaskList.push({type:"confirm",opt:t}),!1;$("body").append(c),setTimeout(function(){$("#confirmBox .box-content").addClass("show")},0),0==$("#mask").length&&$("body").append('<div id="mask" class="mask hide"></div>'),$("input,textarea").blur(),$("#numKeyWord").hide(),$("#mask, #confirmBox").show(),$(".confirmcontent").height()<=152?$(".confirmcontent").css("padding","0.76rem 0.6933334rem"):$(".confirmcontent").css("padding","0.64rem 0.6933334rem"),setTimeout(function(){$(".popBox").css("opacity",1)},10),document.documentElement.style.overflow="hidden",$("#confirmBox").bind("touchmove",function(e){var t=e.target;($(t).is(".popBox")||$(t).is(".box-inner")||$(t).is(".box-content")||$(t).is(".confirmcontent")||$(t).is(".confirmbutton"))&&e.preventDefault()}),$("#confirmBox .confirmbutton div").eq(0).on(end_ev,function(){var e;$("#confirmBox,#mask").remove(),r&&"1"==r?$("#confirmBox").hide():$("#confirmBox,#mask").hide(),$(this).addClass("tapped"),clearTimeout(e),e=setTimeout(function(){$(".tapped").removeClass("tapped")},250),"function"==typeof a&&a(),document.documentElement.style.overflow="",document.body.style.overflow="",T.doPopTask()}),$("#confirmBox  .confirmbutton div").eq(1).on(end_ev,function(){var e;t.okNoClose||($("#confirmBox,#mask").remove(),r&&"1"==r?$("#confirmBox").hide():$("#confirmBox,#mask").hide(),$(this).addClass("tapped")),clearTimeout(e),e=setTimeout(function(){$(".tapped").removeClass("tapped")},250),"function"==typeof n&&n(),document.documentElement.style.overflow="",document.body.style.overflow="",T.doPopTask()}),$("#close").Touch(function(){$("#confirmBox,#mask").remove(),"function"==typeof s&&s(),document.documentElement.style.overflow="",document.body.style.overflow="",T.doPopTask()})},window.tip=function(e,t){if((!t||16<T.Util.getStrLen(e))&&(t="normal"),/go.html#page=index.html/.test(window.location.href)&&T.isNative)return T.Util.showNativeTip(e,t),!1;if(Global.hasTipBox)return clearTimeout(T.showNextTip),T.showNextTip=setTimeout(function(){$("#tipBox").remove(),Global.hasTipBox=!1,tip(e,t)},1),!1;if(Global.hasTipBox=!0,!$("#masktip").length||"loading"!=t)if($(".alertBox").add($("#masktip")).remove(),clearTimeout(window.alert.time),$("input,textarea").blur(),$("#numKeyWord").hide(),"ok"==t||"error"==t||"loading"==t||"warn"==t||"normal"==t){var o='<div id="tipBox" class="tipBox '+t+'"><div id="tipcell"><div id="tipcontent">';o+='<span class="tipicon" id="'+t+'">'+("loading"==t?"<em></em><em></em><em></em><em></em><em></em><em></em><em></em><em></em><em></em><em></em><em></em><em></em>":"")+"</span>",o+="<p>"+e+"</p></div></div></div>",o=$(o),setTimeout(function(){$("body").append(o),$("#tipcontent").width()>document.documentElement.clientWidth-192&&$("#tipcontent").css("width",document.documentElement.clientWidth-192),/go.html#page=index.html/.test(window.location.href)&&$("#tipcontent").css("top","0.2rem"),"normal"==t&&$("#tipBox").css({top:"calc(50% - "+.5*$("#tipBox").height()+"px)"}),"loading"!=t?o.animate({opacity:1},400,"swing",function(){setTimeout(function(){o.animate({opacity:0},500,"swing",function(){Global.hasTipBox=!1,o.remove()})},600)}):o.animate({opacity:1},400,"swing",function(){Global.hasTipBox=!1})},0)}else pageLoading.show(1)},window.showFloat=function(e){var t=(e="string"==typeof e?{html:e}:e||{}).className,o=e.html,i=e.time||3e3,a=e.activeText||"立即查看>",n=e.activeFun;if($("#float").length)$("#float").addClass(t),$("#float #floatContent").html(o),$("#float #floatButton").html(a);else{var l='<div id="float" class="'+t+'" style="top:'+$("#navtitle").height()+'px"><div id="floatContent">'+o+'</div><em id="floatButton">'+a+"</em></div>";$("#main").prepend(l)}$("#float").animate({"margin-top":"0rem"},400),"forever"!=i&&(clearTimeout(Global.floatTimer),Global.floatTimer=setTimeout(function(){$("#float").animate({"margin-top":"-"+$("#float").height()+"px"},400)},i)),$("#float").off().Touch(function(){n&&n()})},$.fn.NumInput=function(n){return this.each(function(){var o={max:999999999,min:1,val:1,up:".up",down:".down",num:1,float:0,pad:1,ts:this,fn:function(){},focusFn:null,blurFn:null};n?$.extend(o,n):o.val=$(this).val()||1;var i=$(this),e=i.parent().find(o.up),t=i.parent().find(o.down);i.val(o.val);i.val();function a(){i.siblings().removeClass("no-click"),i.val()==o.min&&i.prev().addClass("no-click"),i.val()==o.max&&i.next().addClass("no-click")}i.off().on("touchstart",function(e){o.focusFn?o.focusFn():o.fn(),e.stopPropagation()}).blur(function(){""==i.val()&&i.val(o.val),i.val()>o.max?i.val(o.max):i.val()<o.min&&i.val(o.min),o.blurFn?o.blurFn():o.fn()}).on("keyup",function(e){var t=i.val().match(/\d{1,}(\.\d{0,}){0,1}/);""!=(t=t&&t[0]||"")?(i.val(parseFloat(parseFloat(t).toFixed(o.float))),o.min<2&&(i.val()>o.max?i.val(o.max):i.val()<o.min&&i.val(o.min)),isNaN(i.val())&&i.val(o.val)):i.val(""),o.fn(),a()}),0<e.length&&e.off().Touch(function(){i.hasClass("disable")||function(){var e=parseFloat(i.val());e||(e=0);var t=e+o.num;i.val(parseFloat((t>o.max?e:t).toFixed(o.float))),o.blurFn?o.blurFn():o.fn(),a()}()}),!i.hasClass("disable")&&0<t.length&&t.off().Touch(function(){i.hasClass("disable")||function(){var e=parseFloat(i.val());e||(e=1);var t=e-o.num;i.val(parseFloat((t<o.min?e:t).toFixed(o.float))),o.blurFn?o.blurFn():o.fn(),a()}()}),a()}),this};var pageLoading={show:function(e,t){0==$("#tipBox").length&&(tip(t||"","loading"),e&&(0==$("#mask").length&&$(document.body).append($('<div id="mask" class="mask"></div>')),$("#mask").height(window.innerHeight+"px").show()))},hide:function(e){/go.html#page=index.html/.test(window.location.href)&&T.isNative?T.Util.hideNativeTip():setTimeout(function(){$("#tipBox").is(".loading")&&(1==e?$(".tipBox").add($("#mask")).remove():($("#tipBox").add($("#mask")).animate({opacity:0},400,"easing",function(){$(this).remove()}),setTimeout(function(){$("#tipBox.loading").remove()},399)))},10)}},connectSuccessFlag=0,wsClient=null,wsClientNum=0,globalMQArr=[];T.Util={concat_:function(e,t){for(var o=e.concat(),i=0;i<t.length;i++)-1===o.indexOf(t[i])&&o.push(t[i]);return o},ruleRefresh:function(e){var t=$(e)[0].offsetHeight,o=$(e)[0].scrollHeight;t<=o&&o>=Math.max(document.documentElement.clientHeight,window.screen.height)&&noMore($(e))},showDefaultPic:function(e){$(e).attr("src","../img/goods/lazy_load.png")},isEmpty:function(e){if("[object Object]"==Object.prototype.toString.call(e)){var t;for(t in e)return!1;return!0}return null==e||void 0===e||null==e||"undefined"==e||"NULL"==(""+e).toUpperCase()||""+e==""},repeat:function(e,t){for(var o=[],i=0;i<t;i++)o.push(e);return o.join("")},numReg:function(e,t){return e?!/\.\d{2}/.test(e)&&(/\./.test(e)?/[0-9]/.test(t):/[0-9.]/.test(t)):/[0-9]/.test(t)},numFormat:function(e){return 0<parseFloat(e)?"+"+e:e},getTranslate:function(e){var t=$(e).css("transform"),o=$(e).css("-webkit-transform"),i=[];return i=t?t.replace(/\sscale.*/g,"").replace(/[^0-9\-,.]/g,"").split(","):o.replace(/\stranslateZ.*/g,"").replace(/[^0-9\-,.]/g,"").split(","),[parseInt(i[0]),parseInt(i[1])]},priceFormat:function(e){return"<em>"+(e=Number(e).toFixed(2)).split(".")[0]+".</em><em>"+e.split(".")[1]+"</em>"},getCurrentTime:function(){return-1==Global.caseTime&&(Global.caseTime=Date.parse(new Date)/1e3-1451624399),Global.caseTime++},getZeroTime:function(e){return(e=e?new Date(e):new Date).getTime()-36e5*e.getHours()-6e4*e.getMinutes()-1e3*e.getSeconds()},getWeekStr:function(e){return["周日","周一","周二","周三","周四","周五","周六"][new Date(e).getDay()]},dataToUrl:function(e,t){var o=e,i="";return $.each(t,function(e,t){i+=(o.indexOf("?")<0&&!i?"?":"&")+e+"="+(Global.isiOS&&T.isNative&&/[\u4E00-\u9FA5]/.test(t)?encodeURIComponent(encodeURIComponent(t)):t)}),i},preventDefault:function(){$(document).bind("touchmove",function(e){e.preventDefault()})},unPreventDefault:function(){$(document).unbind("touchmove")},copyToClipboard:function(e,t){try{clipboard.writeText(e),!t&&tip("复制成功","ok")}catch(e){!t&&tip("不支持剪贴板","error")}},getPlatform:function(){return Global.platform="",T.isNative?Global.platform="app":Global.isWechat?Global.platform="wechat":Global.isQQ?Global.platform="QQ":Global.isWeibo?Global.platform="weibo":Global.platform="safari",Global.platform},getAppInfo:function(e){var t;if(T.isNative){var o=navigator.userAgent;t=JSON.parse(o.slice(o.indexOf("appInfo/")+8,o.length).split("X-Tingyun-Id")[0])||{}}else t=T.Util.getPara("appInfo")?JSON.parse(Base64.decode(T.Util.getPara("appInfo").replace(/_/g,"="))):T.Storage.get("appInfo")?T.Storage.get("appInfo"):{appName:"掌上拍",appVersion:"1.0.2",bundleID:"com.jingpai.h5",channelCode:Global.isiOS?"iosh5":"adh5",model:"iPhone",deviceModel:"iPhone X",isIphoneX:"1",version:"11.2.1",deviceID:"63FD672A-7110-4B05-93ED-C406D6FFEC57"};return T.Util.isEmpty(t.appName)&&(t.appName=Global.appName),"wangmeng"==(T.Util.getPara("channelCode")?T.Util.getPara("channelCode"):t.channelCode)&&(t.appleID="1355600249"),!T.isNative&&T.Util.getAppVersion(t.appVersion)<102&&(t.appVersion="1.0.2"),!T.isNative&&T.Util.getPara("channelCode")&&(t.channelCode=T.Util.getPara("channelCode")),e&&T.Util.getPara(e)&&(t[e]=T.Util.getPara(e)),T.Storage.set("appInfo",t),e?t[e]:t},getAppVersion:function(e){return parseInt((e||T.Util.getAppInfo("appVersion")).replace(/\./g,""))},getDeviceType:function(){return/iosh5/.test(T.Util.getAppInfo("channelCode"))?"ios":/adh5/.test(T.Util.getAppInfo("channelCode"))?"Android":Global.isiOS?"ios":"Android"},sendDeviceFinger:function(i){window.onload=function(){(new DeviceFingerPrint).get(function(e,t){e;var o=window.location.href.slice(window.location.href.indexOf("download")+9,window.location.href.indexOf(".html")).replace(".html","");/jrtt\d.html/.test(window.location.href)&&(o=o.replace("jrtt","toutiao")),T.Util.xmlHttpRequest({type:"post",errorType:1,reqData:{deviceH5Cd:e,deviceWidth:screen.width,deviceHeight:screen.height,otherChannelCode:o,browserType:Global.isWechat?"wechat":"safari",url:window.location.href,deviceType:Global.isiOS?"ios":"android"},reqUrl:"/user/services/user/setAppChannelH5",callback:function(e){$(document).on("copyfpcode",function(){T.Util.copyToClipboard(e.res_data.fpCode,!0)}),$("#downbtn,.download,.okText").off().live(end_ev,function(){if($(document).trigger("copyfpcode"),setTimeout(function(){T.Util.appDownload(i)},Global.isiOS?0:250),/tuia.html/.test(window.location.href))try{countLog.init()}catch(e){}else if(/jrtt1.html/.test(window.location.href))try{_taq.push({convert_id:"1598250557862973",event_type:"download_start"})}catch(e){}else if(/jrtt2.html/.test(window.location.href))try{_taq.push({convert_id:"1598250805177383",event_type:"download_start"})}catch(e){}})},errorCallback:function(e){$("#downbtn,.download,.okText").off().live(end_ev,function(){tip(Global.neterror),T.Util.appDownload()})}})})}},sendUserBehavior:function(t){var e=T.Storage.get("userinfo")||{},o=T.Util.getAppInfo()||{},i=T.Storage.get("sessionId",1);T.Util.xmlHttpRequest({type:"post",errorType:1,reqData:{userId:e.userId,deviceId:o.deviceID,appVersion:o.appVersion,deviceVersion:"1.0.3",channelCode:o.channelCode,sessionId:i,list:[{conductCode:t&&t.code,busId:T.Util.getShortUrl(),time:(new Date).getTime(),comductDesc:t&&t.event,browsType:T.Util.getPlatform()}]},reqUrl:"/commodity/services/product/conduct.json",callback:function(e){e.res_data&&e.res_data.value&&T.Storage.set("sessionId",e.res_data.value,1),t.callback&&t.callback()},errorCallback:function(e){$("#downbtn").off().Touch(function(){tip(e.msg||Global.neterror)}),t.callback&&t.callback()}}),clearTimeout(Global.sendUserBehaviorTimeout),Global.sendUserBehaviorTimeout=setTimeout(function(){t.callBack&&t.callBack()},3e3)},getDownloadUrl:function(){var e=Global.fullHost;/localhost/.test(e)&&(e="http://dev.ruirun123.cn:8050/");var t=T.Util.getAppInfo("channelCode"),o="/download/index.html?appCode="+Global.appCode+"&channelCode="+T.Util.getAppInfo("channelCode")+"&bundleID="+T.Util.getAppInfo("bundleID")+"&appleID="+T.Util.getAppInfo("appleID")+"&time="+(new Date).getTime();return"zspjpqy"==t&&(o="/download/enterprise.html"),/dev.ruirun123.cn/.test(e)?e+"/pc"+o:e+o},getAppDownloadUrl:function(){T.Util.getPara("c");return/jrtt1.html/.test(window.location.href)?{and:"http://jp.zsp66.com/dl/android/zsp/toutiao1_1.0.2.apk"}:/jrtt2.html/.test(window.location.href)?{and:"http://jp.zsp66.com/dl/android/zsp/toutiao2_1.0.2.apk"}:/tuia.html/.test(window.location.href)?{and:"http://jp.zsp66.com/dl/android/zsp/tuia_1.0.2.apk"}:/zuimei.html/.test(window.location.href)?{and:"http://jp.zsp66.com/dl/android/zsp/zuimei_1.0.2.apk"}:{and:"http://jp.zsp66.com/dl/android/zsp/zslg-v1.0.2.apk"}},showInstallProgress:function(e){setTimeout(function(){var e=3,t="安装中...",o={className:"userDefined install",html:'<div id="progress"><em id="progressBar" style="width:'+e+'%;"></em></div><h2>'+t+"</h2>",cancelText:" ",cancelFun:function(){T.Util.openWindow("../csp.mobileprovision")},okText:/surpriseQiYe.html/.test(window.location.href)?" ":"安装说明",okFun:function(){confirm({className:"userDefined shuoming",html:" ",okText:" ",cancelText:" ",close:!0,closeFun:function(){i()}})},close:!0};function i(){96<=e&&(t="安装完成"),o.html='<div id="progress"><em id="progressBar" style="width:'+e+'%;"></em></div><h2>'+t+"</h2>",confirm(o)}i(),setTimeout(function(){e=parseFloat($("#progressBar").css("width")),clearInterval(Global.progressInterval),Global.progressInterval=setInterval(function(){e+=1,$("#progressBar").css("width",e+"%"),100<=e&&(clearInterval(Global.progressInterval),$(".confirmcontent h2").text("安装完成"))},200)},500)},3e3)},initAppDownload:function(e){var t=T.Util.getAppInfo("appleID");t=T.Util.isEmpty(t)?"1370760333":t,T.Util.sendUserBehavior({code:"APP_DOWNLOAD_"+T.Util.getShortUrl().toUpperCase()+"_PV",event:"APP下载PV",callBack:function(){T.Util.sendUserBehavior({code:"APP_DOWNLOAD_"+T.Util.getShortUrl().toUpperCase()+"_SESSION_TIME",event:"APP下载停留时间"})}}),T.Util.getPara("initdownload")&&(window.location.hash=T.Util.changeHashPara({initdownload:!0}),setTimeout(function(){Global.isiOS?e&&"qiye"==e.type?(T.Util.openWindow("itms-services://?action=download-manifest&url=https://jp.zsp66.com/dl/ios/szpjpqy_release_100.plist"),T.Util.showInstallProgress(e)):T.Util.getAppDownloadUrl().ios?T.Util.openWindow(T.Util.getAppDownloadUrl().ios):T.Util.openWindow("itms-apps://itunes.apple.com/app/tap-black-to-white/id"+t):T.Util.getAppDownloadUrl().and?T.Util.openWindow(T.Util.getAppDownloadUrl().and):T.Util.openWindow("http://jp.zsp66.com/dl/android/zsp/zslg-v1.0.2.apk")},10))},appDownload:function(e){if(T.Util.sendUserBehavior({code:"APP_DOWNLOAD_"+T.Util.getShortUrl().toUpperCase()+"_CLICK",event:"点击下载"}),Global.isiOS){var t=T.Util.getAppInfo("appleID");t=T.Util.isEmpty(t)?"1370760333":t,Global.isQQ||Global.isWeibo||e&&"qiye"==e.type&&Global.isWechat?(confirm({className:"openInBrowser",html:'<img src="../img/download/open_in_safari.png">'}),setTimeout(function(){$(".box-content").off().Touch(function(){$("#confirmBox,#mask").remove()})},0),window.location.hash=T.Util.changeHashPara({initdownload:!0})):e&&"qiye"==e.type?(T.Util.openWindow("itms-services://?action=download-manifest&url=https://jp.zsp66.com/dl/ios/szpjpqy_release_100.plist"),T.Util.showInstallProgress(e)):T.Util.getAppDownloadUrl().ios?T.Util.openWindow(T.Util.getAppDownloadUrl().ios):T.Util.openWindow("itms-apps://itunes.apple.com/app/tap-black-to-white/id"+t)}else Global.isWechat?(confirm({className:"openInBrowser",html:'<img src="../img/download/open_in_browser.png">'}),setTimeout(function(){$(".box-content").off().Touch(function(){$("#confirmBox,#mask").remove()})},0),window.location.hash=T.Util.changeHashPara({initdownload:!0})):T.Util.getAppDownloadUrl().and?T.Util.openWindow(T.Util.getAppDownloadUrl().and):T.Util.openWindow("http://jp.zsp66.com/dl/android/zsp/zslg-v1.0.2.apk")},getAppLogo:function(){var e=T.Util.getAppInfo("channelCode");return("adh5"==e||"iosh5"==e||/qiye/.test(e))&&(e="appstore"),T.Util.isEmpty(T.Util.getAppInfo("appleID"))?Global.fullHost+"/auction/img/logo/legou.png":Global.fullHost+"/auction/img/logo/"+e+".png"},getShareText:function(){T.Util.getAppInfo("channelCode");var e=T.Util.getAppInfo("appName");return{title:e+"，更省钱的正品购物app",description:"23.8万人正在使用的购物app，购物更优惠，更省钱就上"+e}},bin2hex:function(e){for(var t="",o=0;o<e.length;o++){var i=e.charCodeAt(o);t+=T.Util.byte2Hex(i>>8&255),t+=T.Util.byte2Hex(255&i)}return t},byte2Hex:function(e){return e<16?"0"+e.toString(16):e.toString(16)},trim:function(e){return String(e).replace(/\s/g,"")},isPureChinese:function(e){for(var t=e.split(""),o=!1,i=0;i<t.length;i++){if(!/[\u4E00-\u9FA5]/.test(t[i]))return!1;o=!0}return o},getStrLen:function(e){var t=e.split(""),o=0;return $.each(t,function(e,t){/[\u4E00-\u9FA5]/.test(t)?o+=2:o+=1}),o},strSlice:function(e,o){var t=e.split(""),i=0,a="";return $.each(t,function(e,t){/[\u4E00-\u9FA5]/.test(t)?i+=2:i+=1,i<=o&&(a+=t)}),a},hideMidStr:function(e,t,o){var i=String(e).length;return e.slice(0,t)+e.slice(t,i-o).replace(/\d/g,"*")+e.slice(i-o,i)},getFullPic:function(e){return/^http/.test(e)?e:Global.fullHost+e},builder:function(e){try{var t=document.createElement("canvas"),o=t.getContext("2d");e=e||window.location.origin;o.textBaseline="top",o.font="14px 'Arial'",o.textBaseline="buyin",o.fillStyle="#f60",o.fillRect(125,1,62,20),o.fillStyle="#069",o.fillText(e,2,15),o.fillStyle="rgba(102, 204, 0, 0.7)",o.fillText(e,4,17);var i=t.toDataURL().replace("data:image/png;base64,",""),a=atob(i);return T.Util.bin2hex(a.slice(-16,-12))}catch(e){return console.error(e),null}},getDeviceCode:function(e){var t;return window.localStorage&&(t=window.localStorage.getItem(e))||(t=T.Util.builder(e))&&window.localStorage&&window.localStorage.setItem(e,t),t},xmlHttpRequest:function(r){if(0==Global.netWorkStatus){if("IOS"!=Global.OS)return/go.html#page=index.html/.test(window.location.href)||tip(Global.neterror,"error"),void(r.errorCallback&&r.errorCallback(null,{},"timeout"));if("1.0.0"!=T.Util.getAppInfo().appVersion)return/go.html#page=index.html/.test(window.location.href)||tip(Global.neterror,"error"),void(r.errorCallback&&r.errorCallback(null,{},"timeout"))}var d={},c=(new Date).getTime(),e=1;r.needToken&&"no"==r.needToken&&(e=0);var a=Global.fullHost+r.reqUrl;"auth"==r.hostFlag?a=Global.authHost+r.reqUrl:"own"==r.hostFlag?a=r.reqUrl:"appweb"==r.hostFlag&&(a=Global.apiHost+r.reqUrl),r.type&&"get"==r.type.toLowerCase()?(-1!=a.indexOf("?")?a+="&time="+c:a+="?time="+c,d.req_method="GET"):(r.reqData&&(r.reqData.time=c),d.req_method="POST"),d.req_url=encodeURIComponent(a),T.Util.isEmpty(T.Storage.get("userinfo"))||(d.user_code=T.Storage.get("userinfo").user_no);var t={devicefp:Global.devicefp,Language:Global.language,"d-version":r.version?r.version:Global.h_version,tId:T.Util.getAppInfo("channelCode")+(new Date).getTime()+"-"+T.Util.getAppInfo("deviceID"),"client-os":Global.OS,rId:T.Util.getDeviceCode("auctionRid"),cCode:T.Util.getAppInfo("channelCode"),bName:T.Util.getAppInfo("bundleID"),aVersion:T.Util.getAppInfo("appVersion")};!T.Util.isEmpty(T.Storage.get("access_token"))&&e&&(t.Authenticate=T.Storage.get("access_token")),$.ajax({type:r.type?r.type:"POST",url:a,data:JSON.stringify(r.reqData),dataType:r.dataType?r.dataType:"json",timeout:r.timeout?r.timeout:3e4,contentType:"application/json;charset=utf-8",headers:t,async:null==r.async||r.async,success:function(e,t,o){0!=r.reqUrl.indexOf("/commodity/services/template/GET_EXPECT_INFO.json")&&pageLoading.hide(),d.req_status="200";var i=(new Date).getTime();d.expend_time=i-c,d.submit_model="AJAX";var a,n=0;try{var l=new Date(o.getResponseHeader("Date")).getTime();n=(new Date).getTime()-l}catch(e){}if(T.Storage.set("difTime",n),e.msg_code&&0==e.msg_code)r.callback(e,t,o);else if(e.message_code&&1e3==e.message_code)r.callback(e,t,o);else{var s=e.msg||e.result_msg||"no-data";if(d.res_error=s.substring(0,20),"-10"==e.msg_code)return T.Util.sendToken({token:""}),T.Util.clearUserInfo(),r.authError&&r.errorCallback?void r.errorCallback(e):void T.Util.login();"-20"==e.msg_code?(r.errorCallback&&r.errorCallback(e),T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/user/recharge.html?from=buy&money="+parseFloat(Math.abs(e.res_data.value||e.res_data)))):(r.errorType||tip(e.msg||e.result_msg),r.errorCallback&&r.errorCallback(e))}1e3*Collection.maxResTime<d.expend_time&&Collection.filterUrl(r.reqUrl)&&(T.Util.isEmpty(T.Storage.get("collectInfo"))?((a=[]).push(d),T.Storage.set("collectInfo",JSON.stringify(a))):((a=JSON.parse(T.Storage.get("collectInfo"))).push(d),T.Storage.set("collectInfo",JSON.stringify(a)),a.length>=Collection.sendSize&&Collection.collectFlag&&T.Util.sendCollectInfos()))},error:function(e,t){pageLoading.hide(),console.log("main.js xmlHttpRequest 请求返回错误"),console.log("url:"+a+"data:"+JSON.stringify(r.reqData)+"status:"+t),"timeout"!=t&&"abort"!=t&&"error"!=t||(!/go.html#page=index.html/.test(window.location.href)&&r&&tip("("+e.status+")"+Global.neterror,"error"),netOkFlag=!1),d.req_status=e.status;var o,i=(new Date).getTime();(d.expend_time=i-c,d.res_error=e.statusText,d.submit_model="AJAX",Collection.filterUrl(r.reqUrl))&&(T.Util.isEmpty(T.Storage.get("collectInfo"))?((o=[]).push(d),T.Storage.set("collectInfo",JSON.stringify(o))):((o=JSON.parse(T.Storage.get("collectInfo"))).push(d),T.Storage.set("collectInfo",JSON.stringify(o)),o.length>=Collection.sendSize&&Collection.collectFlag&&T.Util.sendCollectInfos()));r.errorCallback&&r.errorCallback(null,e,t)}})},showNoMoney:function(e){var o={className:"userDefined noMoney",html:"<h2>您的"+(Global.isAudit&&"1"==Global.isAudit?"余额":"拍币")+"不足，请充值</h2>",okText:" ",okFun:function(){T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/user/recharge.html?from=buy&money="+parseFloat(Math.abs(e.res_data.value||e.res_data)))},cancelText:" "};function i(){o.className+=" detain",o.html='<h2>确认放弃，本次优惠活动？<img src="../img/nomoney/giveup.png"></h2>',o.cancelFun=function(){},o.okFun=function(){T.Util.showNoMoney(e)},confirm(o)}T.Util.xmlHttpRequest({type:"get",errorType:1,reqUrl:"/user/services/activity/recharge/info?channelCode="+T.Util.getAppInfo("channelCode")+"&appVersion="+T.Util.getAppInfo("appVersion"),callback:function(e){var t=e.res_data.isHaveRecharge;"1"==t?(o.className+=" giveup",o.html+='<img src="../img/nomoney/activity1.png">',o.cancelFun=i):"2"==t?(o.className+=" giveup",o.html+='<img src="../img/nomoney/activity2.png">',o.cancelFun=i):o.html+='<img src="../img/nomoney/nomoney.png">',confirm(o)},errorCallback:function(e){o.html+='<img src="../img/nomoney/nomoney.png">',confirm(o)}})},shopListClick:function(){var t="";/go.html#page=newUserH5.html/.test(window.location.href)&&(t="1"),$(".shopYuyue").off().Touch(function(t){if(1!=$(t).attr("data-isvisitor")){var o=$(t).parent().parent().attr("data-id"),i=$(t).parent().find(".shopMoney em"),a=1*i.html();T.Util.xmlHttpRequest({type:"get",errorType:"1",reqUrl:"/commodity/services/product/visitors.json?expectNo="+$(t).parent().parent().attr("data-no")+"&commodityId="+o,callback:function(e){$(t).attr("data-isvisitor",1),$(t).html("已预约"),tip("预约成功","ok"),i.html(a+1),a+1>=$(t).parent().find(".shopYuYueNeedNum em").html()&&setTimeout(function(){$(t).parent().parent().hasClass("yuYue")&&T.Util.getCommodityInfo(o)},500)},errorCallback:function(e){"1001"==e.msg_code&&"当前商品暂时不能预约"==e.msg||"已预约"==e.msg?setTimeout(function(){$(t).parent().parent().hasClass("yuYue")&&T.Util.getCommodityInfo(o)},500):e&&tip(e.msg,"error")}})}else tip("您已预约哦")}),$(".shopImg,.shopAuctionBox").off().Touch(function(e){$(e).parent().hasClass("auction")||$(e).parent().hasClass("yuYue")?T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/view/go.html#page=goodsDetail.html&id="+$(e).parent().attr("data-id")+"&isNext=1&expectNo="+$(e).parent().attr("data-no")+(t?"&isH5Auction=1":"")):$(e).parent().hasClass("over")&&T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/view/go.html#page=goodsDetail.html&id="+$(e).parent().attr("data-id")+"&expectNo="+$(e).parent().attr("data-no")+(t?"&isH5Auction=1":""))},{noRepeat:1}),$(".shopOverBox,.shopStopBox").off().Touch(function(e){T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/view/go.html#page=goodsDetail.html&id="+$(e).parent().attr("data-id")+"&expectNo="+$(e).parent().attr("data-no")+(t?"&isH5Auction=1":""))},{noRepeat:1}),$(".shopFavorite").off().Touch(function(t){var o;o=$(t).find("i").hasClass("icon-favoriteOn")?2:1,T.Util.xmlHttpRequest({type:"get",reqUrl:"/commodity/services/product/favorite.json?commodityId="+$(t).parent().attr("data-id")+"&type="+o,callback:function(e){1==o?($(t).find("i").removeClass().addClass("icon-favoriteOn"),tip("收藏成功","ok")):("auctionList.html"==T.Util.getParaHash("page")&&"collect"==T.Util.getPara("type")&&$(t).parent().remove(),$("#shopBox .shopList").length||($("html,body").addClass("white"),$("#shopBox").html('<li class="nodata '+T.Util.getParaHash("type")+'"><i></i><h2>暂无数据~</h2><div class="btn">立即去竞拍</div></li>'),$(".nodata .btn").off().Touch(function(){T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/view/go.html#page=auctionList.html&type=hot")})),$(t).find("i").removeClass().addClass("icon-favorite"),tip("取消收藏成功","ok"))},errorCallback:function(e){}})}),$(".auctionTrend").off().Touch(function(e){var t=T.Util.getRootPath()+"/"+Global.webRoot+"/view/go.html#page=auctionTrend.html",o=JSON.parse(Base64.decode($(e).parent().parent().attr("data-item")));o.AUCTION_PRICE=$(this).parent().parent().find(".AUCTION_PRICE").html(),T.Util.openWindow(t+T.Util.dataToUrl(t,o))},{stop:!0})},doShopListHtml:function(e,t){for(var o=[],i=[],a=0;a<e.length;a++){var n="";n="80"==e[a].EXPECT_STATUS?"yuYue":"100"==e[a].EXPECT_STATUS?"auction":"120"==e[a].EXPECT_STATUS||"90"==e[a].EXPECT_STATUS?"stop":e[a].AUCTION_USER_NAME?"over":"over noPeople","100"==e[a].EXPECT_STATUS&&addTimer("#"+e[a].COMMODITY_ID,Math.ceil(e[a].SURPLUS_TIME/1e3));var l,s="",r='<div class="shopFavorite"><i class="'+(e[a].ISFAVORITE?"icon-favoriteOn":"icon-favorite")+'"></i></div>';if(l='class="lozad" src="../img/goods/lazy_load.png" data-src="'+e[a].COMMODITY_LOGO+'"',/auctionList.html&type=collect/.test(window.location.href)&&(s='<div class="userCount">'+(e[a].FAVORTE_COUNT||0)+"</div>"),(/auctionList.html&type=my/.test(window.location.href)||/auctionList.html&type=pre/.test(window.location.href))&&(r=""),i.push('<li class="shopList '+n+'" data-item="'+Base64.encode(JSON.stringify(e[a]))+'" data-id="'+e[a].COMMODITY_ID+'" data-no="'+e[a].EXPECT_NO+'" data-expect_id="'+e[a].EXPECT_ID+'">'+s+"                                    "+r+'                                    <div class="shopImg"><img '+l+'  onerror="T.Util.showDefaultPic(this)"></div>'),/auctionList.html&type=collect/.test(window.location.href))i.push('<div class="shopAuctionBox collect" style="display:block!important;"><div class="avgPrice"><span>平均成交价</span><span><em>¥</em>'+(e[a].AVG_AUCTION_PRICE?e[a].AVG_AUCTION_PRICE.toFixed(2):"--")+"</span></div>"),i.push('<div class="marketPrice">市场价 ¥'+(e[a].MARKET_PRICE?e[a].MARKET_PRICE.toFixed(2):"--")+"</div>"),i.push('<div class="auctionTrend">成交走势</div></div>');else{i.push('<div class="shopYuYueBox"><div class="shopMoney"><span>已预约人数:</span><em>'+e[a].BESPEAK_NUM+"</em></div>"),/page=auctionList.html&type=my/.test(window.location.href)?i.push('<div class="avgPrice"><span>平均成交价</span><span><em>¥</em>'+(e[a].AVG_PRICE?e[a].AVG_PRICE.toFixed(2):"--")+"</span></div>"):i.push('<div class="shopYuYueNeedNum"><span>需要预约人数:</span><em>'+e[a].BESPEAK_MIN_NUM+"</em></div>"),i.push('<div class="shopYuyue" data-isVisitor="'+e[a].IS_VISITOR+'">'+(e[a].IS_VISITOR?"已预约":"预约竞拍")+"</div></div>"),i.push('<div class="shopAuctionBox">');var d="参与竞拍";/page=auctionList.html&type=my/.test(window.location.href)?(d="继续竞拍",i.push('<div class="shopCount"><em class="joinCount">'+e[a].USERCOUNT+"</em>位用户正在竞拍中</div>"),i.push('<div class="avgPrice"><span>平均成交价</span><span><em>¥</em>'+(e[a].AVG_PRICE?e[a].AVG_PRICE.toFixed(2):"--")+"</span></div>")):(i.push('<div class="shopMoney"><span>竞拍价</span><span><em>¥</em><em class="AUCTION_PRICE">'+(1*e[a].AUCTION_PRICE).toFixed(2)+"</em></span></div>"),i.push('<div><em class="shopUserName">'+(e[a].AUCTION_USER_NAME||"<em style='color:#999;'>暂时无人出价</em>")+"</em></div>")),i.push('<div class="shopTime"><span id="'+e[a].COMMODITY_ID+'" data-djs="'+e[a].COUNT_DOWN+'" type-djs="1"><cite>--</cite>:<cite>--</cite>:<cite>--</cite></span><em>'+d+"</em></div></div>"),i.push('<div class="shopOverBox"><div class="shopMoney"><span>竞拍价</span><span><em>¥</em><em class="AUCTION_PRICE">'+(1*e[a].AUCTION_PRICE).toFixed(2)+"</em></span></div>"),/page=auctionList.html&type=my/.test(window.location.href)?i.push('<div class="avgPrice"><span>平均成交价</span><span><em>¥</em>'+(e[a].AVG_PRICE?e[a].AVG_PRICE.toFixed(2):"--")+"</span></div>"):i.push('<div class="shopUserName">'+(e[a].AUCTION_USER_NAME||"<em style='color:#999;'>暂时无人出价</em>")+"</div>"),i.push('<div class="shopStop"><span>'+(e[a].AUCTION_USER_NAME?"已成交":"已结束")+"</div></div>"),i.push('<div class="shopStopBox">'),/page=auctionList.html&type=my/.test(window.location.href)?i.push('<div class="shopMoney">'+("90"==e[a].EXPECT_STATUS?"暂停预约":"暂停竞拍")+'</div><div class="avgPrice"><span>平均成交价</span><span><em>¥</em>'+(e[a].AVG_PRICE?e[a].AVG_PRICE.toFixed(2):"--")+"</span></div>"):i.push('<div class="shopMoney"><span>竞拍价</span><span><em>¥</em><em class="AUCTION_PRICE">--</em></span></div><div class="shopUserName">--</div>'),i.push('<div class="shopStop"><span>'+("90"==e[a].EXPECT_STATUS?"暂停预约":"暂停竞拍")+"</div></div>")}i.push("</li>"),-1==globalMQArr.indexOf("auction/commodity/"+e[a].COMMODITY_ID)&&o.push("auction/commodity/"+e[a].COMMODITY_ID)}var c=T.Storage.get("userinfo");return T.Util.isEmpty(c)||-1==globalMQArr.indexOf("user/favorite/"+c.userId)&&o.push("user/favorite/"+c.userId),T.Util.mqtt(o),i},getCommodityInfo:function(e,s){0!=$('[data-id="'+e+'"]').length&&T.Util.xmlHttpRequest({type:"get",errorType:1,reqUrl:"/commodity/services/template/GET_EXPECT_INFO.json?commodityId="+e,callback:function(e){var t=e.res_data[0];if(!T.Util.isEmpty(t)){var o=T.Util.getParaHash("page");if("goodsRecord.html"==o&&s<t.currentExpectNum)(n=$('li[data-id="'+t.commodityId+'"][data-expect_id="'+t.expectId+'"]')).find(".record-status").html("竞拍结束");else switch(T.Util.expectStatusChange(t,"interface"),o){case"goodsDetail.html":T.goodsDetail.getProductInfo();break;case"allGoods.html":(n=$('.goods-item[data-id="'+t.commodityId+'"]')).attr("data-expect_id")<t.expectId&&T.Util.commodityNewNoInit(t),(l=n.find(".AUCTION_PRICE")).html()<t.auctionPrice&&l.html(parseFloat(1*t.auctionPrice).toFixed(2)).removeClass("animatedSlideOutUp").addClass("animatedSlideOutUp").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){l.removeClass("animatedSlideOutUp")});var i=n.find(".shopUserName"),a=t.auctionUserName||"暂时无人出价";i.html()!=a&&i.html(a).removeClass("animatedZoomOut").addClass("animatedZoomOut").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){i.removeClass("animatedZoomOut")});break;default:var n,l;if((n=$('li[data-id="'+t.commodityId+'"]')).attr("data-expect_id")<t.expectId&&T.Util.commodityNewNoInit(t),"goodsRecord.html"==o&&(dom=$('li[data-id="'+t.commodityId+'"][data-expect_id="'+t.expectId+'"]'),0==dom.length))return void console.log("投注记录没找对应期号的商品：id"+t.commodityId+"data-expect_id="+t.expectId);(l=n.find(".AUCTION_PRICE")).html()<t.auctionPrice&&l.html(parseFloat(1*t.auctionPrice).toFixed(2)).removeClass("animatedSlideOutUp").addClass("animatedSlideOutUp").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){l.removeClass("animatedSlideOutUp")});i=n.find(".shopUserName"),a=t.auctionUserName||"暂时无人出价";i.html()!=a&&i.html(a).removeClass("animatedZoomOut").addClass("animatedZoomOut").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){i.removeClass("animatedZoomOut")})}}},errorCallback:function(e){console.log(e)}})},expectStatusChange:function(e,t){var o=T.Util.getParaHash("page");if(!T.Util.isEmpty(e))if("goodsRecord.html"==o&&e.expectStatus&&100==e.expectStatus)addTimer("#"+e.commodityId,t&&"interface"==t?Math.ceil(e.SURPLUS_TIME/1e3):parseInt($("#"+e.commodityId).attr("data-djs")));else{if("allGoods.html"==o)var i=$('.goods-item[data-id="'+e.commodityId+'"]');else i=$('li[data-id="'+e.commodityId+'"]');if("goodsRecord.html"!=o)for(var a=0;a<i.length;a++){var n=$(i[a]);if("allGoods.html"==o)switch(e.expectStatus.toString()){case"80":n.removeClass().addClass("goods-item pre");break;case"100":"auctionList.html"==o&&"pre"==T.Util.getPara("type")&&T.Storage.set("auctionListPreTag","1"),addTimer("#"+e.commodityId,t&&"interface"==t?Math.ceil(e.SURPLUS_TIME/1e3):parseInt($("#"+e.commodityId).attr("data-djs"))),n.removeClass().addClass("goods-item auction");break;case"90":case"120":n.removeClass().addClass("goods-item stop");break;default:n.removeClass().addClass("goods-item over")}else switch(e.expectStatus.toString()){case"80":n.removeClass().addClass("shopList yuYue");break;case"100":addTimer("#"+e.commodityId,t&&"interface"==t?Math.ceil(e.SURPLUS_TIME/1e3):parseInt($("#"+e.commodityId).attr("data-djs"))),n.removeClass().addClass("shopList auction");break;case"90":n.find(".shopStop span").html("暂停预约"),n.removeClass().addClass("shopList stop");break;case"120":n.find(".shopStop span").html("暂停竞拍"),n.removeClass().addClass("shopList stop");break;default:n.removeClass().addClass("shopList over")}}}},commodityNewNoInit:function(e){var t;"allGoods.html"==T.Util.getParaHash("page")?((t=$('.goods-item[data-id="'+e.commodityId+'"]')).attr("data-expect_id",e.expectId),t.attr("data-no",e.expectNo),t.find(".AUCTION_PRICE").html((1*(e.auctionPrice||"0")).toFixed(2)),t.find(".shopUserName").html("<em style='color:#999;'>暂时无人出价</em>"),t.find(".prenow span").html("0"),t.find(".preline span").html(e.minVisitor||e.bespeakMinNum),t.attr("data-isvisitor",0),t.find(".goods-submit").attr("data-isvisitor",0).find(".pre").html("预约")):((t=$('li[data-id="'+e.commodityId+'"]')).attr("data-expect_id",e.expectId),t.attr("data-no",e.expectNo),t.find(".shopYuyue").attr("data-isvisitor",0).html("预约竞拍"),t.find(".shopYuYueBox .shopMoney em").html("0"),t.find(".yuYueInfoBox .prenow em").html("0"),t.find(".shopYuYueBox .shopYuYueNeedNum em").html(e.minVisitor||e.bespeakMinNum),t.find(".AUCTION_PRICE").html((1*(e.auctionPrice||"0")).toFixed(2)),t.find(".shopUserName").html("<em style='color:#999;'>暂时无人出价</em>"))},showGoodsRecommend:function(a){Global.pageIndex=1,Global.hasMore=!1,T.Util.xmlHttpRequest({type:"get",reqUrl:"/commodity/services/shop/shopType.json?type=2&page="+Global.pageIndex+"&limit=6",callback:function(e){var t=e.res_data.value.INFO;2==e.res_data.value.ISEND?(Global.hasMore=!0,Global.pageIndex++):Global.hasMore=!1;for(var o=[],i=0;i<t.length;i++)i%3==0&&o.push('<div class="row">'),o.push('<div class="shopList" data-tjid="'+t[i].COMMODITY_ID+'" data-no="'+t[i].EXPECT_NO+'"><h2>'+t[i].COMMODITY_NAME+'</h2><img class="lozad" src="../img/goods/lazy_load.png" data-src="'+t[i].COMMODITY_LOGO+'"><p>近期成交 ￥'+(t[i].PRE_AUCTION_PRICE||"--")+"</p></div>"),i%3==2&&o.push("</div>");$("#intelligentBox").show(),$("#intelligentBox").length||$("#content").append('<div id="intelligentBox"><div class="inteligentHead"><h2>智能推荐</h2></div><div class="inteligentList"></div></div>'),o.length&&(a?$(".inteligentList").append(o.join("")):$(".inteligentList").html(o.join(""))),lozad().observe(),$(".inteligentList .shopList").off().Touch(function(e){T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/view/go.html#page=goodsDetail.html&id="+$(e).attr("data-tjid")+"&expectNo="+$(e).attr("data-no")+"&isNext=1")})},errorCallback:function(e,t,o){tip(e?e.msg:Global.neterror,"error")}})},messAgeArriver:function(e){if(e.payloadString&&""!=e.payloadString){var o=JSON.parse(e.payloadString);console.log("msgTime:"+(new Date).getTime()+" "+e.payloadString);var t=T.Util.getParaHash("page");if("goodsDetail.html"!=t)if("allGoods.html"==t){if(0==(i=$('.goods-item[data-id="'+o.commodityId+'"]')).length)return void console.log("不存在商品：id"+o.commodityId)}else if("goodsRecord.html"==t){if(0==(i=$('li[data-id="'+o.commodityId+'"][data-expect_id="'+o.expectId+'"]')).length)return void console.log("投注记录没找对应期号的商品：id"+o.commodityId+"data-expect_id="+o.expectId)}else{var i;if(0==(i=$('[data-id="'+o.commodityId+'"]')).length)return void console.log("不存在商品：id"+o.commodityId)}else if("goodsDetail.html"==t){if(expectId=expectId||"",console.log("msg.expectId:"+o.expectId+"---expectId:"+expectId),o.commodityId!=commodityId)return;if(o.expectId!=expectId&&("FAVORITE"!=o.type||"VISITORS"!=o.type||"COUPON"!=o.type))return void(o.expectId>expectId&&("前往下一期"!==$("#auction-other-box").html()||"商品竞拍已结束"!==$("#auction-other-box").html())&&T.goodsDetail.auctionOver())}if("REPLACE"==o.type&&"goodsDetail.html"==t){var a="好友“"+o.uname+"”正为您助力，免费获得"+o.count+"次出价";3<o.count&&(a="好友“"+o.uname+"”助力猛烈，免费获得"+o.count+"次自动出价"),$("#autoNum").val(o.repCou),$("#auction-submit h2").html("好友助力中"),$(".daipaiTip").html(a).removeClass("dpTipNone").addClass("dpTipNone").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){$(this).removeClass("dpTipNone")})}if("COUNT_DOWN"==o.type)return;if("AUCTION"==o.type)if("goodsDetail.html"==t){if(o.auctionPrice<=auctionPrice)return;addTimer(".cutDownTime",parseInt($("#"+o.commodityId).attr("data-djs"))),$("#goodsdetail-box").hasClass("preauction")&&T.goodsDetail.getProductInfo();var n=T.Storage.get("userinfo");if(!T.Util.isEmpty(n)&&-1<o.userId.split(",").indexOf(n.userId)){if(0<o.repCou)$("#autoNum").val(o.repCou),$("#autoNum").addClass("disable"),$("#addsub em").addClass("disable"),$("#auction-submit h2").html("好友助力中");else if(0<o.count?($("#autoNum").val(o.count),$("#autoNum").addClass("disable"),$("#addsub em").addClass("disable"),$("#auction-submit h2").html("取消自动出价")):($("#autoNum").val(1),$("#autoNum").removeClass("disable"),$("#addsub em").removeClass("disable"),$("#auction-submit h2").html("出价")),o.acctMap)for(c in o.acctMap)if("1_2"==c){var l=1*$("#cjgMoney").attr("data-m")+1*o.acctMap[c];$("#cjgMoney").attr("data-m",l);var s=1*$("#cjgMoney").attr("data-mk"),r=1*$("#cjgMoney").attr("data-rr");1e3<=s&&s/10<=l&&($(".cjgMoney,.yxhMoney").show(),$("#cjgMoney").html((s-l*(r/100)).toFixed(2)))}}else T.goodsDetail.auctionYhm();if($("#USERCOUNT").html(o.allCount),$("#auctionlist li").eq(0).show(),$("#auctionlist li").eq(3).remove(),o.auctionPrice!=auctionPrice){auctionPrice=o.auctionPrice;var d=$("#priceBox");$("#priceBox").append("<div>"+parseFloat(auctionPrice).toFixed(2)+"</div>"),d.animate({marginTop:-d.find("div").height()/70+"rem"},500,function(){d.css("margin-top",0),d.find("div").eq(0).remove(),$(".AUCTION_PRICE").html(parseFloat(o.auctionPrice).toFixed(2))})}"none"==$("#leadeuser").css("display")&&$("#leadeuser").show(),$("#lastBidder span").html(T.Util.isEmpty(o.uname)?o.userMobile:o.uname),$("#lastBidder em").html("("+o.area+")"),$("#leaduser").attr("src","../img/usercenter/photo.png").attr("src",o.upic),$("#ALLCOUNT").html(1*$("#ALLCOUNT").html()+1),$("#auctionlist").prepend('<li class="auctionlist-item hide" data-userid="'+o.userId+'" data-money="'+o.auctionPrice+'"><img src="'+o.upic+'"><em>'+(T.Util.isEmpty(o.uname)?o.userMobile:o.uname)+"</em><em>出局</em><em>("+(o.area||"未知区域")+")</em><em>￥"+(1*o.auctionPrice).toFixed(2)+"</em></li>"),1<$("#auctionlist li").length&&$("#auctionlist").show()}else for(var c=0;c<i.length;c++){var p=$(i[c]);if(/page=auctionList.html&type=my/.test(window.location.href)&&p.find(".joinCount").html(o.allCount),"allGoods.html"==t?p.removeClass().addClass("goods-item auction"):"goodsRecord.html"!=t&&p.removeClass().addClass("shopList auction"),p.find(".AUCTION_PRICE").html(parseFloat(o.auctionPrice).toFixed(2)).removeClass("animatedSlideOutUp").addClass("animatedSlideOutUp").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){$(this).removeClass("animatedSlideOutUp")}),p.find(".shopUserName").html(T.Util.isEmpty(o.uname)?o.userMobile:o.uname).removeClass("animatedZoomOut").addClass("animatedZoomOut").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){$(this).removeClass("animatedZoomOut")}),"goodsRecord.html"==t){n=T.Storage.get("userinfo");!T.Util.isEmpty(n)&&-1<o.userId.split(",").indexOf(n.userId)&&p.find(".my-count em").html(1*p.find(".my-count em").html()+1)}addTimer("#"+o.commodityId,parseInt($("#"+o.commodityId).attr("data-djs")))}if("BALANCE"==o.type)if("goodsDetail.html"==t)setTimeout(function(){$("#numKeyWord").hide();var e=T.Storage.get("userinfo");if(!T.Util.isEmpty(e)&&-1<o.userId.split(",").indexOf(e.userId)&&!goodsDetailHasTipSuccessFlag){goodsDetailHasTipSuccessFlag=!0,newUserHasAuctionSuccessFlag=!0,e.isSuccessAuction="1",T.Storage.set("userinfo",e),1<o.userId.split(",").length&&-1<o.userId.split(",").indexOf(e.userId)&&($("#lastBidder span").html(T.Util.isEmpty(e.nickName)?e.userMobile:e.nickName),o.area&&1<o.area.split(",").length&&$("#lastBidder em").html("("+o.area.split(",")[o.userId.split(",").indexOf(e.userId)]+")"),$("#leaduser").attr("src","../img/usercenter/photo.png").attr("src",e.userPic)),-1==o.userId.split(",").indexOf(e.userId)&&($("#lastBidder span").html(o.uname),$("#lastBidder em").html("("+o.area+")"),$("#leaduser").attr("src","../img/usercenter/photo.png").attr("src",o.upic));var t=o.isDelegate&&1!=o.isDelegate;!T.isNative&&T.Util.getPara("isH5Auction")?confirm({className:"userDefined h5AuctionSuccess",html:"",okText:"立即下载APP领取",okFun:function(){T.goodsDetail.getAuctionRecord(),T.Util.appDownload()},close:!0,closeFun:function(){T.goodsDetail.getAuctionRecord()}}):t?confirm({className:"userDefined auctionSuccess",html:'<img src="'+commodityLogo+'"><h2>成功拍中商品！</h2><p>立即付<em>'+o.auctionPrice+'</em>元</p><p class="Successdesc">获取本商品</p>',cancelText:"立即付款",cancelFun:function(){T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/view/pay.html?commodityId="+commodityId+"&expectId="+o.expectId+"&auctionPrice="+o.auctionPrice+"&payType=auctionSuc&isentity="+o.IS_ENTITY)},okText:" ",okFun:function(){},close:!0,okNoClose:!0}):confirm({className:"userDefined auctionSuccess",html:'<img src="'+commodityLogo+'"><h2>成功拍中商品！</h2><p>立即付<em>'+o.auctionPrice+'</em>元</p><p class="Successdesc">获取本商品或委托拍卖此商品委托成功即可提现</p>',cancelText:"委托拍卖",cancelFun:function(){T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/view/weituoAuction.html?commodityId="+commodityId+"&id="+o.expectId+"&tax="+o.tax+"&delegatePrice="+o.delegatePrice+"&auctionPrice="+o.auctionPrice+"&marketPrice="+marketPrice.toFixed(2))},okText:"立即付款",okFun:function(){T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/view/pay.html?commodityId="+commodityId+"&expectId="+o.expectId+"&auctionPrice="+o.auctionPrice+"&payType=auctionSuc&isentity="+o.IS_ENTITY)},close:!0})}T.Util.isEmpty(o.userId)&&alert("商品无人出价已流拍，将进入下一期竞拍",function(){T.goodsDetail.getProductInfo("isNext")}),T.goodsDetail.auctionOver()},100);else if("goodsRecord.html"==t)for(c=0;c<i.length;c++){(p=$(i[c])).find(".record-status").html("竞拍结束")}else for(c=0;c<i.length;c++){p=$(i[c]);if(o.expectId<p.attr("data-expect_id"))return;"allGoods.html"==t?T.Util.isEmpty(o.userId)?p.removeClass().addClass("goods-item over noPeople"):p.removeClass().addClass("goods-item over"):T.Util.isEmpty(o.userId)?p.removeClass().addClass("shopList over noPeople"):p.removeClass().addClass("shopList over")}if("START"==o.type&&"goodsDetail.html"!=t&&"goodsRecord.html"!=t)for(c=0;c<i.length;c++){p=$(i[c]);console.log("商品id："+o.commodityId+"开始新一期"),p.attr("data-expect_id",o.newExpectId),p.attr("data-no",o.expectNo),T.Util.expectStatusChange(o),T.Util.commodityNewNoInit(o)}if("STATUS_CHANGE"==o.type)if("goodsDetail.html"==t)switch(o.expectStatus){case"80":break;case"100":$(".cutDownTime").show().siblings().hide(),T.goodsDetail.getProductInfo();break;case"90":$("#stopBox").html("暂停预约"),$("#stopBox").show().siblings().hide(),$("#auction-other-box").show().html("商品暂停预约"),$("#auction-submit-box").hide();break;case"120":$("#stopBox").html("暂停竞拍"),$("#stopBox").show().siblings().hide(),$("#auction-other-box").show().html("商品暂停竞拍"),$("#auction-submit-box").hide()}else"goodsRecord.html"!=t&&(i.attr("data-expect_id")<o.expectId&&T.Util.commodityNewNoInit(o),T.Util.expectStatusChange(o));if("FAVORITE"==o.type){if("goodsDetail.html"!=t)if(1==o.favoriteType)for(c=0;c<i.length;c++){(p=$(i[c])).find(".shopFavorite i").removeClass().addClass("icon-favoriteOn")}else for(c=0;c<i.length;c++){(p=$(i[c])).find(".shopFavorite i").removeClass().addClass("icon-favorite")}"goodsDetail.html"==t&&$("#FAVORTE_COUNT").html(o.allCount)}if("VISITORS"==o.type)if("goodsDetail.html"!=t)for(c=0;c<i.length;c++){p=$(i[c]);if("allGoods.html"==t){n=T.Storage.get("userinfo");!T.Util.isEmpty(n)&&-1<o.userId.split(",").indexOf(n.userId)&&(p.attr("data-isvisitor",1),p.find(".goods-submit").attr("data-isvisitor",1).find(".pre").html("已预约")),p.find(".prenow span").html(o.currentVisitor)}else{n=T.Storage.get("userinfo");!T.Util.isEmpty(n)&&-1<o.userId.split(",").indexOf(n.userId)&&p.find(".shopYuyue").attr("data-isvisitor",1).html("已预约"),p.find(".yuYueInfoBox .prenow em").html(o.currentVisitor),p.find(".shopYuYueBox .shopMoney em").html(o.currentVisitor)}}else $("#BESPEAK_NUM").html(o.currentVisitor);"COUPON"==o.type&&confirm({className:"userDefined weituoQuan",html:"",okText:"我知道了"})}},mqtt:function(i,o){if(!T.Util.isEmpty(o)||0!=i.length){T.Util.isEmpty(o)&&0<i.length&&(globalMQArr=T.Util.concat_(i,globalMQArr));var a=location.hostname;-1<window.location.origin.indexOf("://localhost")&&(a="jp.ruirun123.cn");var e=location.port,n=location.protocol;0==window.location.origin.indexOf("file")&&(n=Global.apiHost.split(":")[0],a=Global.apiHost.split(":")[1],e=Global.apiHost.split(":")[2]);var l=T.Util.isEmpty(e)?"https:"==n?443:80:1*e,s="TMP/"+parseInt(1e6*Math.random(1e4))%102400;T.Util.isEmpty(T.Storage.get("access_token"))||T.Util.isEmpty(T.Storage.get("userinfo"))||(s="P/"+T.Storage.get("userinfo").userId+"-"+parseInt(1e6*Math.random(1e4))%102400),void 0!==wsClient&&null!=wsClient||((wsClient=new Paho.MQTT.Client(a,l,"/ws","myclientid_"+s)).onConnectionLost=function(e){console.log("链接断开 - errorCode:"+e.errorCode+"----msg:"+e.errorMessage),s=T.Util.isEmpty(T.Storage.get("userinfo"))?"TMP/"+parseInt(1e6*Math.random(1e4))%102400:"P/"+T.Storage.get("userinfo").userId+"-"+parseInt(1e6*Math.random(1e4))%102400,(connectSuccessFlag=0)!=Global.netWorkStatus&&r("fail")},wsClient.onMessageArrived=function(e){T.Util.messAgeArriver(e)}),1==connectSuccessFlag?(console.log("建立链接成功后增加的订阅"),o&&"unsubscribe"==o?(c(),o=""):o&&"viewAgain"==o?(d("all"),o=""):d()):r()}function r(e){var t={userName:"guest",password:-1<a.indexOf("dev.ruirun123.cn")?"guest":"JPai2018",keepAliveInterval:15,onSuccess:function(){console.log("建立链接成功"),pageLoading.hide(),connectSuccessFlag=1,wsClientNum=0,o&&"unsubscribe"==o?(c(),o=""):e&&"fail"==e||o&&"viewAgain"==o?(d("all"),o=""):d()},onFailure:function(e){connectSuccessFlag=0,wsClientNum=10<++wsClientNum?10:wsClientNum,setTimeout(function(){0!=Global.netWorkStatus&&r("fail")},1e3*wsClientNum),console.log("建立链接失败 - 失败消息："+e.errorMessage)}};"https:"==n&&(t.useSSL=!0),console.log("建立链接至 "+a+":"+l+"---链接的id为："+s),0==connectSuccessFlag&&(connectSuccessFlag=2,wsClient.connect(t))}function d(e){var t;if(t=e&&"all"==e?globalMQArr:i,$.isArray(t))for(var o=0;o<t.length;o++)wsClient.subscribe(t[o],{qos:0});else wsClient.subscribe(t,{qos:0})}function c(){if($.isArray(globalMQArr))for(var e=0;e<globalMQArr.length;e++)wsClient.unsubscribe(globalMQArr[e]);else wsClient.unsubscribe(globalMQArr)}},sendCollectInfos:function(){if(!T.Util.isEmpty(T.Storage.get("collectInfo"))){var e="Web",t="";if(T.isNative){var o=window.navigator.userAgent;(t=o.match(/QAPP[\/\s](\d+[._]\d+[._]\d+)/))&&t.length&&(t=(t[1]||"0.0.0").replace(/\_/g,".")),e=/iPhone|iPad|iPod/i.test(o)?"IOS":"Android"}var i=T.Storage.get("collectInfo");T.Storage.remove("collectInfo"),$.ajax({url:Global.fullHost+"/collect-web/services/collect/req.json",dataType:"string",type:"POST",data:JSON.stringify({s_model:e,d_code:"",h_version:Global.h_version,s_version:t,item:i}),success:function(e){},error:function(){}})}},aliPay:function(e,t){T.isNative?api.aliPay(e,function(e){t(e)}):console.log("请在原生客户端打开")},weixinPay:function(e,t){T.isNative?api.weixinPay(e,function(e){t(e)}):console.log("请在原生客户端打开")},thirdShare:function(e,t){if(e&&e.url){var o=e.url.split("#");e.url=o[0]+"#"+T.Util.changeHashPara({channelCode:Global.isiOS?"iosh5":"adh5"},e.url)}T.isNative?api.thirdShare(e,function(e){(0==e.data&&"IOS"==Global.OS||0==e.errorCode&&"Android"==Global.OS)&&T.Util.xmlHttpRequest({type:"get",errorType:1,authError:1,reqUrl:"/commodity/services/invite/share.json",callback:function(e){},errorCallback:function(e){}}),t(e)}):e&&e.url&&(window.location.href=e.url)},thirdLogin:function(e,t){T.isNative&&api.thirdLogin({type:e},function(e){t(e)})},notifyRenderFinish:function(){T.isNative&&api.notifyRenderFinish({},function(e){})},clearCache:function(){T.isNative&&api.clearCache({},function(e){})},clearUserInfo:function(){T.Storage.remove("access_token"),T.Storage.remove("userinfo"),T.Storage.remove("accountDetail"),T.Storage.remove("myShaidan"),T.Storage.remove("myWeituo"),T.Storage.remove("payOrder"),T.Storage.remove("message"),T.Storage.remove("bankCardList"),T.Storage.remove("selectedCard"),T.Storage.remove("userAddress"),T.Storage.remove("selectAddressInfo")},sendToken:function(e){T.isNative&&api.sendToken(e,function(e){})},showNativeTip:function(e,t){T.isNative&&api.showNativeTip({msg:e,type:t})},hideNativeTip:function(){T.isNative&&api.showNativeTip({type:"hideloading"})},goTabbar:function(e){T.isNative?api.goTabbar({index:e},function(e){}):window.location.href="1"==e?T.Util.getRootPath()+"/"+Global.webRoot+"/view/go.html#page=latestDeal.html":"2"==e?T.Util.getRootPath()+"/"+Global.webRoot+"/view/go.html#page=allGoods.html":"3"==e?T.Util.getRootPath()+"/"+Global.webRoot+"/view/go.html#page=mall.html":"4"==e?T.Util.getRootPath()+"/"+Global.webRoot+"/view/go.html#page=mine.html":T.Util.getRootPath()+"/"+Global.webRoot+"/view/go.html#page=index.html"},openWindow:function(e,t){T.isNative?api.openWindow($.extend({url:e},t),function(e){}):window.location.href=e},isNeedLogin:function(){T.needLoginPage=["accountDetail.html","address.html","drawing.html","myBankCard.html","myShaidan.html","myWeituo.html","payOrder.html","selectBankCard.html","auctionList.html&type=my","auctionList.html&type=collect","goodsRecord.html.html"];for(var e=0;e<T.needLoginPage.length;e++)if(window.location.href.match(T.needLoginPage[e]))return!0},login:function(e){var t=T.Util.isNeedLogin();window.location.href.match(/\/user\/login\.html/)||T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/user/login.html"+(t?"?needLogin=true":"")+(e&&e.isBack?(t?"&":"?")+"isBack=true":""))},back:function(e,t){"undefined"!=typeof closeBeforeBack&&"function"==typeof closeBeforeBack&&closeBeforeBack(),$("input,textarea").blur(),$("#numKeyWord").hide(),T.isNative?e&&e.index?api.goTabbar(e,t):api.closeWindow(e,t):1<window.history.length?window.history.back():window.location.href=T.Util.getRootPath()+"/"+Global.webRoot+"/view/go.html#page=index.html"},getCurrentPosition:function(t){T.isNative&&103<=T.Util.getAppVersion()&&api.LocationInterface(t,function(e){t.successCallback&&t.successCallback(e)},function(e){e.msg&&tip(e.msg)})},filterScript:function(e){return e=e||"",e=(e=(e=(e=(e=decodeURIComponent(e)).replace(/<.*>/g,"")).replace(/(java|vb|action)script/gi,"")).replace(/[\"\'][\s ]*([^=\"\'\s ]+[\s ]*=[\s ]*[\"\']?[^\"\']+[\"\']?)+/gi,"")).replace(/[\s ]/g,"&nbsp;")},jsLoad:function(e,t){var o;T.loadedJsUrl||(T.loadedJsUrl=""),"object"==typeof e&&(1<e.length&&(o=e.slice(0)),e=e[0]);var i=document.createElement("script");("?m="+Math.random(),i.src=e,-1==T.loadedJsUrl.indexOf(e))?(T.loadedJsUrl+=e,o&&(i.onload=i.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(o.shift(),this.JsLoad(o),this.onload=this.onreadystatechange=null)}),document.body.appendChild(i),i.onload=i.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||t&&"function"==typeof t&&t()}):t&&"function"==typeof t&&setTimeout(function(){t()},100)},getPara:function(e,t){for(var o=(void 0===t?window.location.href:t).split(/[?#]/g),i=1;i<o.length;i++)for(var a=o[i],n=(a=a.split("&")).length-1;a[n];n--)if(a[n]=a[n].split("="),a[n][0]==e)try{return this.filterScript(a[n][1])}catch(e){return a[n][1]}return""},getParaSearch:function(e,t){var o=void 0===t?window.location.href:t;if(2<=(o=o.split("?")).length){for(var i=(o=(o=(o=o[1]).split("#")[0]).split("&")).length-1;o[i];i--)if(o[i]=o[i].split("="),o[i][0]==e)try{return this.filterScript(o[i][1])}catch(e){}return""}},getParaHash:function(e,t){var o=void 0===t?window.location.href:t;if(2<=(o=o.split("#")).length){o=(o=(o=o[1]).split("?")[0]).split("&");for(var i=0;o[i];i++)if(o[i]=o[i].split("="),o[i][0]==e)try{return this.filterScript(o[i][1])}catch(e){}return""}},changeHashPara:function(e,t){var o=void 0===t?window.location.href:t,i="",a=!1;if(2<=(o=o.split("#")).length){o=(o=o[1]).split(/[&?]/g);for(var n=0;o[n];n++){for(var l in o[n]=o[n].split("="),e)o[n][0]==l&&(a=!0,o[n][1]=e[l]);T.Util.isEmpty(o[n][0])||T.Util.isEmpty(o[n][1])||(i+=(i?"&":"")+o[n][0]+"="+String(o[n][1]))}}if(!a)for(var l in e)T.Util.isEmpty(l)||T.Util.isEmpty(e[l])||(i+=(i?"&":"")+l+"="+e[l]);return i},getShortUrl:function(){for(var e=window.location.href,t=e.indexOf(".html")-1,o=e.split(""),i=[],a=t;0<=a&&"/"!=o[a];a--)i.push(o[a]);return i.reverse().join("")},getRootPath:function(){var e=window.document.location.href,t=window.document.location.pathname,o=e.indexOf(t),i=e.substring(0,o);t.substring(0,t.substr(1).indexOf("/")+1);if(0==window.location.href.indexOf("file")){var a=window.location.href.split("/auction/")[0];return a.length&&"/"==a.substr(a.length-1,a.length)&&(a=a.substr(0,a.length-1)),a}return i},getHostInfo:function(){var e=window.document.location.href,t=window.document.location.pathname,o=e.indexOf(t);return e.substring(0,o)},doTimeParse:function(e,t){if(!T.Util.isEmpty(e)){var o=new Date(e).toString().split("GMT")[0].split(" ");return o[1]+" "+o[2]+", "+o[3]+" "+o[4].split(":")[0]+":"+o[4].split(":")[1]}},arrayUnique:function(e){for(var t=[],o={},i=0;i<e.length;i++)o[e[i]]||(t.push(e[i]),o[e[i]]=1);return t},parseNumber:function(e){return/\.\d+/.test(e)&&(e=2<(""+e).length-1-(""+e).indexOf(".")?new Number(e).toFixed(2)+"":""+e),(""+e).replace(/\d{1,3}(?=(\d{3})+(\.\d*)?$)/g,"$&,")},openBetInfoPage:function(e){T.isNative?e&&e.type?api.openBetInfoPage({type:e.type},function(e){}):api.openBetInfoPage():e&&e.type?window.location.href=T.Util.getRootPath()+"/"+Global.webRoot+"/quiz/chooseDetails.html":console.log("请在原生包里打开")},kefu:function(t,e){if(kefuhttpFlag){kefuhttpFlag=!1;var o="http://chat8.live800.com/live800/chatClient/chatbox.jsp?companyID=931028&configID=152291&jid=2750116277&JPNativeTitle=在线客服",i="/user/services/app/liveSign.json";e&&(i=i+"?memo="+encodeURI(e)),T.Util.xmlHttpRequest({type:"get",errorType:"1",authError:"1",reqUrl:i,callback:function(e){kefuhttpFlag=!0,o=o+"&info="+e.res_data.value,t&&"native"==t?window.location.href=o:Global.isiOS&&T.isNative?T.Util.openWindow(Base64.encode(o),{isBase64Encode:1}):T.Util.openWindow(o)},errorCallback:function(){kefuhttpFlag=!0,console.log("接口报错啦"),"native"==t?window.location.href=o:T.Util.openWindow(o)}})}},htmlScroll:function(e){e?(document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden",$("#mask").bind("touchmove",function(e){e.preventDefault()})):($("#mask").unbind("touchmove"),document.documentElement.style.overflow="",document.body.style.overflow="")}};var httpErrorMsg=function(e){var t="Request error occurred";switch(e){case 0:case 1:t="Network anomaly";break;case 2:t="Server response exception";break;case 3:t="Accept server response exception";break;case 4:t="Network anomaly"}return t};"function"==typeof $.fn.Touch&&($("#back").Touch(function(){T.Util.back()}),$("#aggree-protocol i").off().Touch(function(){$(this).toggleClass("checked")}),$("#aggree-protocol span").off().Touch(function(){$(this).siblings("i").toggleClass("checked")}),$("#aggree-protocol em").off().Touch(function(){$(this).parent().is(".user-protocol")?T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/user/regProtocol.html"):T.Util.openWindow(T.Util.getRootPath()+"/"+Global.webRoot+"/user/protocol.html")},{stop:!0})),T.User={getUInfo:function(i,e){if(T.Util.isEmpty(T.Storage.get("access_token"))||-1<T.Storage.get("access_token").indexOf("-"))return T.isNative&&-1==window.location.href.indexOf("/auction/user/login.html")&&(T.Util.clearUserInfo(),T.Util.sendToken({token:""})),void(i&&"function"==typeof i&&i());var t={type:"get",reqUrl:"/user/services/user/getUser.json",callback:function(e){var t=e.res_data.value||{};T.Storage.set("userinfo",t);var o=T.Storage.get("isSetPwd")||{};o[T.Storage.get("lastLoginInfo")]=t.isSetPwd,T.Storage.set("isSetPwd",o),i&&"function"==typeof i&&i(e)},errorCallback:function(e){i&&i(e)}};T.Util.isEmpty(e)||"1"!=e||(t.authError=1,t.errorType=1),T.Util.xmlHttpRequest(t)},getUserAddress:function(o){if(!T.Storage.get("access_token"))return!1;T.Util.xmlHttpRequest({type:"get",reqUrl:"/user/services/user/userAddressList.json",callback:function(e){var t=e.res_data.value;t&&t.length&&T.Storage.set("userAddress",t),o&&o(t)},errorCallback:function(){}})}},T.appToH5={init:function(o,t,i,a,n){api=lib.API,document.addEventListener("EVENT_INIT",function(e){if(0==window.location.origin.indexOf("file")&&(Global.fullHost=e.result.apiHost,Global.apiHost=e.result.apiHost,Global.authHost=e.result.authHost,Global.payHost=e.result.payHost),console.log("initEvent---result:"+JSON.stringify(e.result)),e.result.netWorkStatus&&(Global.netWorkStatus=e.result.netWorkStatus),e.result.webVersion&&(Global.webVersion=e.result.webVersion,Global.webVersion!=T.Storage.get("webVersion")))for(var t in T.Storage.set("webVersion",Global.webVersion),localStorage)/\.html/.test(t)&&T.Storage.remove(t);if(e.result.devicefp&&(Global.devicefp=e.result.devicefp),e.result.invitation&&(Global.inviteChannelCode=e.result.invitation),e.result.appCode&&(Global.appCode=e.result.appCode),e.result.isAudit&&(Global.isAudit=e.result.isAudit),e.result.appName&&(Global.appName=e.result.appName),e.result.language&&(Global.language=e.result.language),e.result.deviceCode&&(Global.deviceCode=e.result.deviceCode),e.result.showWeiXin&&(Global.showWeiXin=e.result.showWeiXin),e.result.showQQ&&(Global.showQQ=e.result.showQQ),e.result.showWeiBo&&(Global.showWeiBo=e.result.showWeiBo),e.result.canShare?Global.canShare=e.result.canShare:Global.isAndroid&&(Global.canShare=1),Global.isAudit&&"1"==Global.isAudit&&(Global.canShare=0),Global.isAndroid&&T.Util.getAppVersion()<=100&&(Global.canShare=1),!e.result.isLogin)return T.Storage.remove("access_token"),T.Storage.remove("userinfo"),o&&"function"==typeof o&&o(),"undefined"!=typeof nativeEventInit&&"function"==typeof nativeEventInit&&nativeEventInit(),void(Global.isFirst=!1);e.result.accessToken&&(e.result.accessToken==T.Storage.get("access_token")?(o&&"function"==typeof o&&o(),T.User.getUInfo(function(){},"1")):(T.Storage.set("access_token",e.result.accessToken),T.User.getUInfo(function(){o&&"function"==typeof o&&o(),"undefined"!=typeof nativeEventInit&&"function"==typeof nativeEventInit&&nativeEventInit(),Global.isFirst=!1},"1")))},!1),api.eventListener({},function(e){console.log("app到H5事件初始化"+JSON.stringify(e))}),document.addEventListener("EVENT_NETWORK",function(e){console.log("EVENT_NETWORK---result:"+JSON.stringify(e.result)),Global.netWorkStatus=e.result.netWorkStatus,0<Global.netWorkStatus&&t&&t(e)},!1),document.addEventListener("EVENT_APPEAR",function(e){console.log("EVENT_APPEAR---result:"+JSON.stringify(e.result)),e.result.netWorkStatus&&(Global.netWorkStatus=e.result.netWorkStatus,0==e.result.netWorkStatus)||(e.result.accessToken&&(T.Storage.set("access_token",e.result.accessToken),T.User.getUInfo(function(){},"1")),t&&t(e))},!1),document.addEventListener("EVENT_DISAPPEAR",function(e){console.log("EVENT_DISAPPEAR---result:"+JSON.stringify(e.result)),i&&i(e)},!1),document.addEventListener("EVENT_LOCK",function(e){console.log("EVENT_LOCK---result:"+JSON.stringify(e.result)),a&&a(e)},!1),document.addEventListener("EVENT_UNLOCK",function(e){console.log("EVENT_UNLOCK---result:"+JSON.stringify(e.result)),n&&n(e)},!1)}};var addTimerList=[],addTimer=function(){var n;return function(e,t,o){n||(n=setInterval(l,1e3)),"goodsDetail.html"!=T.Util.getParaHash("page")&&(t+=1);for(var i={ele:e,time:t<1?1:t,eid:o||"00"},a=0;a<addTimerList.length;a++)if(e&&addTimerList[a]&&e===addTimerList[a].ele)return void(addTimerList[a].time=t);addTimerList.push(i)};function l(){for(var e=0;e<addTimerList.length;e++){addTimerList[e].time!=--addTimerList[e].time<0&&addTimerList[e].time;var t=$(addTimerList[e].ele);"goodsDetail.html"==T.Util.getParaHash("page")?t.find("i").html(o(addTimerList[e].time,addTimerList[e].ele,addTimerList[e].eid)):t.html(o(addTimerList[e].time,addTimerList[e].ele,addTimerList[e].eid)),addTimerList[e].time||addTimerList.splice(e--,1)}}function o(e,t,o){if("allGoods.html"==T.Util.getParaHash("page")&&$(t).parent().parent().hasClass("stop"))return"已暂停";if(0<e){if("goodsDetail.html"==T.Util.getParaHash("page")){var i=Math.floor(e/60).toString();i.length<=1&&(i="0"+i);var a=Math.floor(e-60*i).toString();return a.length<=1&&(a="0"+a),0!=e?addMsTimer(".cutDownTime span",100):$(".cutDownTime span").html("00"),i+":"+a}if("cjg.html"==T.Util.getParaHash("page")||$('.cjgShopInfo[data-id="'+t.replace("#","")+'"]').length||-1<window.location.href.indexOf("orderDetail.html")){var n=parseInt(e/60/60/24,10),l=parseInt(e/60/60%24,10),s=parseInt(e/60%60,10),r=parseInt(e%60,10);return n.length<=1&&(n="0"+n),l.length<=1&&(l="0"+l),s.length<=1&&(s="0"+s),r.length<=1&&(r="0"+r),-1<window.location.href.indexOf("orderDetail.html")?0<n?"剩余:"+n+"天"+l+"时"+s+"分":"剩余:"+l+"时"+s+"分"+r+"秒":0<n?n+"天"+l+"时"+s+"分后失效":l+"时"+s+"分"+r+"秒后失效"}1==e&&T.Util.getCommodityInfo(t.replace("#",""),o);var d=Math.floor(e/3600).toString();d.length<=1&&(d="0"+d);var c=Math.floor(e/60%60).toString();c.length<=1&&(c="0"+c);var p=Math.floor(e%60).toString();return p.length<=1&&(p="0"+p),d+":"+c+":"+p}return"goodsDetail.html"==T.Util.getParaHash("page")?(T.goodsDetail.getProductInfo("fromDjsTimer"),$(".cutDownTime span").html("00"),"00:00"):"cjg.html"==T.Util.getParaHash("page")?"已失效":(T.Util.getCommodityInfo(t.replace("#",""),o),"00:00:01")}}(),addMsTimer=function(){var a,n=[];return function(e,t){a||(a=setInterval(l,10));for(var o={ele:e,time:t},i=0;i<n.length;i++)if(e&&n[i]&&e===n[i].ele)return void(n[i].time=t);n.push(o)};function l(){for(var e=0;e<n.length;e++)n[e].time!=--n[e].time<0&&n[e].time,$(n[e].ele).html(t(n[e].time)),n[e].time||n.splice(e--,1)}function t(e){if(0<e){var t=Math.floor(e%100).toString();return t.length<=1&&(t="0"+t),t}return"00"}}();